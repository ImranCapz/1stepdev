import{r as n,a as M,c as O,b as H,j as e,Z as u,a2 as D,L as m,J as f,K as R,a4 as V,_ as F,a5 as G,P as r}from"./index-D04hwy3T.js";import{e as g,d as j,h as J}from"./index-BUAo15R1.js";import{C,b as $}from"./react-content-loader.es-BoLIKdLX.js";import{d as k}from"./index-oQQ0I35d.js";import{a as I}from"./index-BrE5-GJu.js";import{b as y}from"./index-RWC9EQmS.js";function K({provider:s}){const[p,N]=n.useState(!1),[a,P]=n.useState(0),{currentUser:o}=M(i=>i.user),[l,L]=n.useState("urlsearchTerm"),[q,w]=n.useState(!0),[z,v]=n.useState(!1),S=O(),b=new URLSearchParams(S.search).get("searchTerm"),c=H(),T=encodeURIComponent(s.fullName).replace(/%20/g,"-"),B=encodeURIComponent(s.address.city),_=encodeURIComponent(s.address.state).replace(/%20/g,"-"),A=encodeURIComponent(s.address.pincode),x=`/provider/${T}`,h=`?city=${B}?state=${_}&service=${l}&pincode=${A}`;n.useEffect(()=>{L(b),window.scrollTo({top:0})},[b]);function E(){console.log("close modal"),v(!1)}const U=async()=>{if(!o){v(!0);return}try{c(V({userId:o._id,providerId:s._id})),F.success(`Provider ${p?"removed from":"added to"} favorites`),N(i=>!i)}catch(i){console.error(i),F.error("Failed to update favorite status")}};return n.useEffect(()=>{(async()=>{if(o){try{const t=await c(G({userId:o._id,providerId:s._id}));t.payload!==void 0&&N(t.payload)}catch(t){console.log(t)}w(!1)}})()},[o,c,s._id]),n.useEffect(()=>{(async()=>{try{const d=await(await fetch(`/server/rating/getreview/${s._id}`)).json();P(d)}catch(t){console.error("Error:",t)}w(!1)})()},[s._id]),e.jsx(e.Fragment,{children:q?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-center text-xl text-slate-700 w-full",children:[e.jsx("div",{className:"md:hidden block mb-2",children:e.jsxs(C,{viewBox:"0 0 320 220",speed:2,height:250,width:360,backgroundColor:"#f5f5f5",foregroundColor:"#D1BEE0",children:[e.jsx("circle",{cx:"40",cy:"60",r:"36"}),e.jsx("rect",{x:"90",y:"34",rx:"4",ry:"4",width:"100",height:"9"}),e.jsx("rect",{x:"90",y:"56",rx:"4",ry:"4",width:"140",height:"13"}),e.jsx("rect",{x:"90",y:"80",rx:"4",ry:"4",width:"290",height:"9"}),e.jsx("rect",{x:"20",y:"110",rx:"4",ry:"4",width:"150",height:"9"}),e.jsx("rect",{x:"20",y:"130",rx:"4",ry:"4",width:"190",height:"9"}),e.jsx("rect",{x:"20",y:"150",rx:"4",ry:"4",width:"100",height:"9"}),"(button)",e.jsx("rect",{x:"20",y:"180",rx:"4",ry:"4",width:"290",height:"34"})]})}),e.jsx("div",{className:"lg:block hidden",children:e.jsxs(C,{viewBox:"0 0 300 300",speed:2,height:500,width:400,backgroundColor:"#e2e2e2",foregroundColor:"#D1BEE0",children:[e.jsx("circle",{cx:"150",cy:"60",r:"56"}),e.jsx("rect",{x:"100",y:"125",rx:"4",ry:"4",width:"100",height:"9"}),e.jsx("rect",{x:"75",y:"146",rx:"4",ry:"4",width:"140",height:"13"}),e.jsx("rect",{x:"50",y:"170",rx:"4",ry:"4",width:"190",height:"9"}),e.jsx("rect",{x:"50",y:"190",rx:"4",ry:"4",width:"150",height:"9"}),e.jsx("rect",{x:"50",y:"210",rx:"4",ry:"4",width:"220",height:"9"}),e.jsx("rect",{x:"50",y:"253",rx:"4",ry:"4",width:"60",height:"9"}),"(button)",e.jsx("rect",{x:"165",y:"240",rx:"4",ry:"4",width:"110",height:"34"})]})})]})}):e.jsxs("div",{className:"group mt-4 w-full relative border pr-card shadow-md hover:shadow-lg overflow-hidden rounded-lg transition-all hover:-translate-y-2 duration-500 ease-in-out",children:[s.totalBookings===null?e.jsx("div",{className:"md:flex flex-col items-center bg-white text-sm p-1.5 hidden",children:e.jsx("p",{className:"text-white",children:"No Recent Bookings"})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col items-center bg-green-300 text-sm p-1.5",children:s.totalBookings!==null&&e.jsx(e.Fragment,{children:s.totalBookings.length===1?e.jsx("p",{children:"Got Booking in Recently"}):e.jsxs("p",{children:[s.totalBookings," Bookings in Recent Times"]})})})}),e.jsx("button",{onClick:U,className:"p-2 absolute top-0 right-0 md:top-9 md:right-2 z-10",children:p?e.jsx(I,{className:"text-pink-600 size-6 lg:size-7 hover:bg-pink-100 rounded-md transition duration-300"}):e.jsx(I,{className:"text-zinc-400 size-6 lg:size-7 hover:bg-zinc-200 rounded-md transition duration-300"})}),e.jsxs("div",{className:"hidden md:flex flex-col p-2 absolute top-9 left-2 z-10 justify-center items-center ",children:[e.jsx(k,{className:"h-4 w-4 lg:size-5 star"}),e.jsx("p",{className:"text-sm lg:text-base text-gray-600 font-bold truncate w-full",children:a&&a.totalrating!==void 0&&(a.totalrating==="0.00"||a.totalrating==="0"||isNaN(parseFloat(a.totalrating)))?"No reviews":`${parseFloat(a==null?void 0:a.totalrating).toFixed(2)} (${(a==null?void 0:a.totalratings)||0})`})]}),e.jsxs(u,{show:z,size:"md",onClose:E,popup:!0,children:[e.jsx(u.Header,{}),e.jsx(u.Body,{children:e.jsx(D,{})})]}),e.jsxs("div",{className:"flex flex-col gap-2 p-3 w-full items-start md:items-center",children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("div",{className:"hidden w-full md:flex flex-col items-center",children:[e.jsx("div",{className:"relative w-40 h-40 items-center rounded-full overflow-hidden md:border-4 border-gray-100 lg:mt-4 group-hover:-translate-y-2 duration-700 ease-in-out",children:e.jsx("img",{src:s.profilePicture,alt:"provider profile",className:"absolute w-full h-full object-cover",loading:"lazy"})}),e.jsx(m,{to:{pathname:x,search:h,state:{searchTerm:l}},onClick:()=>c(f(s._id)),children:e.jsxs("div",{className:"flex flex-row items-center gap-2 truncate text-2xl font-semibold provideritem-name hover:underline mt-2",children:[s.fullName,s.verified===!0&&e.jsx(e.Fragment,{children:e.jsx(R,{content:"Verifed Profile",animation:"duration-500",placement:"bottom",children:e.jsx($,{})})})]})}),e.jsx("div",{className:"flex flex-row items-center text-xs md:text-base 2xl:text-lg provideritem-service font-semibold truncate",children:Array.isArray(s.name)?(()=>{const i=s.name.findIndex(d=>l&&d.toLowerCase()===l.toLowerCase());let t=[...s.name];return i!==-1&&(t=[s.name[i],...s.name.slice(0,i),...s.name.slice(i+1)]),e.jsxs(e.Fragment,{children:[t.slice(0,1),t.length>1?e.jsxs(e.Fragment,{children:[","," ",e.jsxs(m,{className:"hover:underline",to:`/search?searchTerm=${encodeURIComponent(t[1])}&address=${s.address.city}`,children:[t[1].slice(0,14),t[1].slice(14)?"...":""]})]}):null,t.length>2?` +${t.length-2}more`:""]})})():s.name}),e.jsx("div",{className:"md:flex flex-col items-center hidden",children:e.jsxs("div",{className:"items-start",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(g,{className:"h-4 w-4 lg:size-5 icon-color"}),e.jsxs("p",{className:"text-sm lg:text-base provideritem-service truncate w-full",children:[s.address.addressLine1," ",s.address.city,","," ",s.address.state]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 lg:size-5 icon-color"}),e.jsxs("p",{className:"text-sm lg:text-base provideritem-service truncate w-full",children:[s.experience," years experience overall"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"h-4 w-4 lg:size-5 icon-color"}),e.jsx("p",{className:"text-sm lg:text-base provideritem-service truncate w-full",children:Array.isArray(s.therapytype)?`${s.therapytype.slice(0,4).join(", ")}`:`${s.therapytype}`})]})]})})]}),e.jsxs("div",{className:"w-full flex md:hidden",children:[e.jsx("div",{className:"relative h-16 w-16 md:w-28 md:h-28 rounded-full overflow-hidden border-gray-100",children:e.jsx("img",{src:s.profilePicture,alt:"provider profile",className:"absolute w-full h-full object-cover",loading:"lazy"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4 star"}),e.jsx("p",{className:"text-sm text-gray-600 font-bold truncate w-full",children:a&&a.totalrating!==void 0&&(a.totalrating==="0.00"||a.totalrating==="0"||isNaN(parseFloat(a.totalrating)))?"No reviews":`${parseFloat(a==null?void 0:a.totalrating).toFixed(2)} (${(a==null?void 0:a.totalratings)||0})`})]}),e.jsx(m,{to:{pathname:x,search:h,state:{searchTerm:l}},onClick:()=>c(f(s._id)),children:e.jsxs("div",{className:"flex flex-row items-center gap-2 truncate text-xl font-semibold provideritem-name hover:underline",children:[s.fullName,s.verified===!0&&e.jsx(e.Fragment,{children:e.jsx(R,{content:"Verifed Profile",animation:"duration-500",placement:"right",children:e.jsx($,{})})})]})}),e.jsx("div",{className:"text-xs md:text-sm provideritem-service font-semibold truncate w-full",children:Array.isArray(s.name)?(()=>{const i=s.name.findIndex(d=>l&&d.toLowerCase()===l.toLowerCase());let t=[...s.name];return i!==-1&&(t=[s.name[i],...s.name.slice(0,i),...s.name.slice(i+1)]),e.jsxs(e.Fragment,{children:[t.slice(0,1),t.length>1?e.jsxs(e.Fragment,{children:[","," ",e.jsx(m,{className:"hover:underline",to:`/search?searchTerm=${encodeURIComponent(t[1])}&address=${s.address.city}`,children:t[1]})]}):null,t.length>2?` +${t.length-2} more`:""]})})():s.name}),e.jsxs("div",{className:"md:inline hidden",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(g,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.address.addressLine1," ",s.address.city,","," ",s.address.state]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.experience," years experience overall"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"h-4 w-4 icon-color"}),e.jsx("p",{className:"text-sm provideritem-service truncate w-full",children:Array.isArray(s.therapytype)?`${s.therapytype.slice(0,4).join(", ")}`:`${s.therapytype}`})]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:hidden",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(g,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.address.addressLine1,",",s.address.city]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.experience," years experience overall"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"h-4 w-4 icon-color"}),e.jsx("p",{className:"text-sm provideritem-service truncate w-full",children:Array.isArray(s.therapytype)?`${s.therapytype.slice(0,4).join(", ")}`:`${s.therapytype}`})]})]})]}),e.jsx("hr",{className:"w-full border-gray-200"}),e.jsxs("div",{className:"flex flex-row items-center justify-between w-full",children:[e.jsxs("div",{className:"md:flex hidden provideritem-name items-center pl-2 md:text-xl 2xl:text-2xl",children:[e.jsx(J,{className:"pt-0.5"}),Math.floor(s.regularPrice)]}),e.jsx("div",{className:"p-1.5 flex flex-col w-full md:items-end",children:e.jsx(m,{to:{pathname:x,search:h,state:{searchTerm:l}},children:e.jsx("button",{onClick:()=>c(f(s._id)),className:" card-btn w-full md:w-auto p-2 lg:p-2 rounded-md font-semibold transition duration-300",children:"View Profile"})})})]})]})]})})}K.propTypes={provider:r.shape({_id:r.string.isRequired,imageUrls:r.arrayOf(r.string).isRequired,name:r.arrayOf(r.string),therapytype:r.arrayOf(r.string).isRequired,fullName:r.string.isRequired,experience:r.string.isRequired,address:r.shape({addressLine1:r.string.isRequired,city:r.string.isRequired,state:r.string.isRequired,pincode:r.number.isRequired}).isRequired,totalrating:r.number,totalBookings:r.number,numberofratings:r.number,description:r.string.isRequired,profilePicture:r.string.isRequired,regularPrice:r.number.isRequired,verified:r.bool}).isRequired};export{K as P};
