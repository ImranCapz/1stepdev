import{G as $,r,a as B,b as M,j as e,e as O,O as V,L as j,K as A,Q as G,i as q,k as N,m as z,_ as H}from"./index-BNw4CVOz.js";import{g as J,r as K,u as Q,a as W}from"./index.esm2017-0IjlcwDk.js";import{a as Y}from"./index-BqYu2Osb.js";function X(i){return $({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(i)}function te(){const i=r.useRef(null),[m,w]=r.useState(),[o,y]=r.useState(0),[S,P]=r.useState(!1),[d,b]=r.useState({}),x=r.useRef(null),[C,k]=r.useState(!1),[U,g]=r.useState(!1),[h,v]=r.useState([]),{currentUser:l,loading:E,error:D}=B(s=>s.user),n=M();r.useEffect(()=>{m&&_(m)},[m]);const _=async s=>{const t=J(G),a=new Date().getTime()+s.name,p=K(t,a),u=Q(p,s);u.on("state_changed",c=>{const I=c.bytesTransferred/c.totalBytes*100;y(Math.round(I))},c=>{P(!0)},()=>{W(u.snapshot.ref).then(c=>b({...d,profilePicture:c}))})},F=s=>{s.preventDefault(),i.current.click()},R=async s=>{s.preventDefault();try{x.current.continuousStart(50),n(q());const a=await(await fetch(`/server/user/update/${l._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json();if(a.success===!1){n(N(a));return}n(z(a)),k(!0)}catch(t){n(N(t))}finally{x.current.complete()}},f=s=>{b({...d,[s.target.id]:s.target.value})},L=async()=>{try{g(!1);const t=await(await fetch(`/server/user/providers/${l._id}`)).json();if(t.success===!1){g(!0);return}v(t)}catch{g(!0)}},T=async s=>{try{const a=await(await fetch(`/server/provider/delete/${s}`,{method:"DELETE"})).json();if(a.success===!1)return console.log(a),H.success("Provider Deleted Successfully");v(p=>p.filter(u=>u._id!==s))}catch(t){console.log(t.message)}};return e.jsxs("div",{className:"bg-slate-100 p-3 mx-auto",children:[e.jsx(O,{ref:x,color:"#ff9900",height:3}),e.jsxs("h1",{className:"flex flex-col p-2 mb-4 font-bold text-2xl text-gray",children:["Account Settings :"," "]}),e.jsxs("div",{className:"p-10 bg-white rounded-lg border",children:[e.jsx("div",{className:"",children:e.jsxs("form",{className:"flex flex-col items-start gap-7 md:w-[900px]",onSubmit:R,children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:i,hidden:!0,accept:"image/*",onChange:s=>w(s.target.files[0])}),e.jsx("div",{className:"relative w-34 h-34 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:F,children:[e.jsx("img",{src:d.profilePicture||l.profilePicture,alt:"profile",className:"w-32 h-32 rounded-full object-cover border-4 border-[lightgray]"}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-10 h-10"}),e.jsx("p",{className:"text-white text-xs",children:"Change Picture"})]})]})}),e.jsx("p",{className:"text-sm self-center",children:S?e.jsx("span",{className:"text-red-500",children:"Please upload a valid image"}):o>0&&o<100?e.jsx("span",{children:`Uploading: ${o}%`}):o===100?e.jsx("span",{className:"text-green-700",children:"Image Uploaded Successfully"}):""})]}),e.jsxs("div",{className:"flex flex-col md:w-1/2 gap-2 relative",children:[e.jsx("label",{htmlFor:"username",className:"text-xl text-slate-600",children:"Username"}),e.jsxs("div",{className:"flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(V,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{defaultValue:l.username,type:"text",id:"username",required:!0,placeholder:"username",className:"flex-grow text-xl pl-3 text-gray-800 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:f})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Email Address"}),e.jsxs("div",{className:"flex items-center mt-2 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(X,{className:"ml-3 text-xls w-5 h-5 text-gray-400"}),e.jsx("input",{defaultValue:l.email,type:"email",id:"email",placeholder:"email",className:"flex-grow text-xl pl-3 w-3/4 mx-auto text-gray-500 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:f,disabled:!0})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Password"}),e.jsxs("div",{className:"flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(Y,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{type:"text",id:"password",placeholder:"password",className:"flex-grow text-xl pl-3 text-gray-500 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:f})]}),e.jsx("button",{className:"bg-blue-600 text-xl font-semibold text-white mt-6 p-3 rounded-lg hover:opacity-95 transition-all disabled:opacity-80",children:E?"Saving...":"Save Changes"})]})]})}),e.jsx("p",{className:"text-red-700 mt-7",children:D&&"something went wrong"}),e.jsx("p",{className:"text-green-700 mt-7",children:C&&"Updated Successfully"}),e.jsx("button",{onClick:L,className:"text-green-700 w-full",children:"Show Created Provider"}),e.jsx("p",{className:"text-red-700 mt-7",children:U?"Error showing Provider":""}),h&&h.length>0&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-center mt-7 text-2xl font-semibold",children:"Your Providers"}),h.map(s=>e.jsxs("div",{className:" rounded-lg p-3 flex gap-4 justify-between items-center",children:[e.jsx(j,{to:`/provider/${s._id}`,children:e.jsx("img",{src:s.imageUrls[0],alt:"provider cover",className:"h-16 w-16 object-contain"})}),e.jsx(j,{onClick:()=>n(A(s._id)),className:"flex-1 font-semibold hover:underline truncate",to:`/provider/${s._id}`,children:e.jsx("p",{children:s.fullName})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("button",{onClick:()=>T(s._id),className:"text-red-700 uppercase",children:"Delete"}),e.jsx(j,{to:"/dashboard?tab=providers",children:e.jsx("button",{className:"text-green-700 uppercase",children:"EDIT"})})]})]},s._id))]})]})]})}export{te as default};
