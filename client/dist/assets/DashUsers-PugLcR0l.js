import{r as l,j as e}from"./react-DiIsFRGf.js";import{a as r,M as h,B as u}from"./flowbite-react-Fyy4migT.js";import{a as b}from"./react-redux-Dbcc7wIi.js";import{Z as k,_ as N,$ as v}from"./react-icons-8x28c1Op.js";import"./@floating-ui-DNv8sKgv.js";import"./aria-hidden-DQ5UC2Eg.js";import"./tabbable-DNPBiPWX.js";import"./react-dom-byw35-pb.js";import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-CLl2ARCe.js";function B(){const{currentUser:o}=b(s=>s.user),[n,i]=l.useState([]),[j,m]=l.useState(!0),[f,c]=l.useState(!1),[x,g]=l.useState(""),[p,w]=l.useState(!0);console.log("CurrentUser",o),l.useEffect(()=>{const s=async()=>{try{const t=await fetch("/server/user/getusers"),a=await t.json();t.ok&&(i(a.users),w(!1),a.users.length<9&&m(!1))}catch(t){console.log(t.message)}};o.isAdmin&&s()},[o.isAdmin]);const y=async()=>{const s=n.length;try{const t=await fetch(`/server/user/getusers?startIndex=${s}`),a=await t.json();t.ok&&(i(d=>[...d,...a.users]),a.users.length<9&&m(!1))}catch(t){console.log(t.message)}},C=async()=>{try{const s=await fetch(`/server/user/delete/${x}`,{method:"DELETE"}),t=await s.json();s.ok?(i(a=>a.filter(d=>d._id!==x)),c(!1)):console.log(t.message)}catch(s){console.log(s.message)}};return e.jsxs("div",{className:"table-auto overflow-x-scroll md:mx-auto p-3 scrollbar scrollbar-track-slate-100 scrollbar-thumb-slate-300 dark:scrollbar-track-slate-700 dark:scrollbar-thumb-slate-500 ",children:[p?e.jsx("p",{children:"Loading Users..."}):o.isAdmin&&n.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(r,{hoverable:!0,className:"shadow-md w-full",children:[e.jsxs(r.Head,{children:[e.jsx(r.HeadCell,{children:"Date created"}),e.jsx(r.HeadCell,{children:"User image"}),e.jsx(r.HeadCell,{children:"Username"}),e.jsx(r.HeadCell,{children:"Email"}),e.jsx(r.HeadCell,{children:"Admin"}),e.jsx(r.HeadCell,{children:"Delete"})]}),n.map(s=>e.jsx(r.Body,{className:"divide-y",children:e.jsxs(r.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(r.Cell,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(r.Cell,{children:e.jsx("img",{src:s.profilePicture,alt:s.username,className:"w-10 h-10 object-cover bg-gray-500 rounded-full"})}),e.jsx(r.Cell,{children:s.username}),e.jsx(r.Cell,{children:s.email}),e.jsx(r.Cell,{children:s.isAdmin?e.jsx(k,{className:"text-green-500"}):e.jsx(N,{className:"text-red-500"})}),e.jsx(r.Cell,{children:e.jsx("span",{onClick:()=>{c(!0),g(s._id)},className:"font-medium text-red-500 hover:underline cursor-pointer",children:"Delete"})})]})},s._id))]}),j&&e.jsx("button",{onClick:y,className:"w-full text-teal-500 self-center text-sm py-7",children:"Show more"})]}):e.jsx("p",{children:"You have no users yet!"}),e.jsxs(h,{show:f,onClose:()=>c(!1),popup:!0,size:"md",children:[e.jsx(h.Header,{}),e.jsx(h.Body,{children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-14 w-14 text-gray-400 dark:text-gray-200 mb-4 mx-auto"}),e.jsx("h3",{className:"mb-5 text-lg text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this user?"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(u,{color:"failure",onClick:C,children:"Yes, I'm sure"}),e.jsx(u,{color:"gray",onClick:()=>c(!1),children:"No, cancel"})]})]})})]})]})}export{B as default};
