import{r as l,j as e}from"./react-DiIsFRGf.js";import{t as re,u as se,v as ae,w as le}from"./@firebase-Bu6QwI_o.js";import{o as ie,e as oe}from"./index-WeOTgdyh.js";import{a as k,u as ne}from"./react-redux-Dbcc7wIi.js";import{_ as c}from"./react-hot-toast-BDpxPdYe.js";import{a as de}from"./react-router-DJddit7Q.js";import{S as j}from"./react-select-xtze-_c4.js";import{S as ce,C as ue,a as A}from"./country-state-city-B5NRDuuX.js";import{_ as me}from"./react-spinners-D_wes01j.js";import{F as pe}from"./flowbite-react-Fyy4migT.js";import{I as fe}from"./react-phone-number-input-ASBvvjCp.js";import{e as _}from"./react-icons-8x28c1Op.js";import"./@floating-ui-DNv8sKgv.js";import"./aria-hidden-DQ5UC2Eg.js";import"./tabbable-DNPBiPWX.js";import"./react-dom-byw35-pb.js";import"./scheduler-CzFDRTuY.js";import"./idb-BXWtuYvb.js";import"./typewriter-effect-BuJ_1VG0.js";import"./react-router-dom-CiSQRV_j.js";import"./@remix-run-Dj_uVd1O.js";import"./prop-types-DepTH4Nk.js";import"./firebase-CbIrmIWz.js";import"./tslib-DM0Z-3HQ.js";import"./@reduxjs-lV2PETub.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./react-top-loading-bar-BLjLFdAM.js";import"./@material-tailwind-CfbTshu2.js";import"./classnames-BarBPuyi.js";import"./tailwind-merge-BXtt6hLZ.js";import"./framer-motion-aHfq1aqb.js";import"./hey-listen-CLGyRvAf.js";import"./style-value-types-Pspc_Zm6.js";import"./popmotion-CLyVFpOP.js";import"./framesync-BCkQ-MAm.js";import"./@motionone-0R8ZHWcy.js";import"./material-ripple-effects-BS6XNNYc.js";import"./redux-persist-BVedYr7E.js";import"./javascript-time-ago-BndSdHl7.js";import"./relative-time-format-Cuui0pOH.js";import"./@babel-CabbEptY.js";import"./@emotion-CEC3ZH7r.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-YPZU7XtI.js";import"./use-isomorphic-layout-effect-YmIeajr3.js";import"./memoize-one-BdPwpGay.js";import"./use-sync-external-store-CLl2ARCe.js";import"./goober-vt3s6TGe.js";import"./libphonenumber-js-fczAwKKS.js";import"./input-format-C2kHUKsc.js";function ft(){const{currentUser:m}=k(t=>t.user);k(t=>t.provider);const[N,R]=l.useState([]),[T,q]=l.useState(""),[C,p]=l.useState(!1),[w,x]=l.useState(!1),[g,y]=l.useState(!1),[f,$]=l.useState({}),L=de(),D=l.useRef(null),V=ne(),[B,M]=l.useState(""),[r,o]=l.useState({imageUrls:[],name:"",email:"",qualification:"",license:"",fullName:"",experience:"",phone:B,address:{addressLine1:"",country:"",state:"",city:"",street:"",pincode:""},therapytype:"",availability:{morningStart:"",morningEnd:"",eveningStart:"",eveningEnd:""},regularPrice:"",description:"",profilePicture:""}),[n,u]=l.useState({phone:!1,email:!1,description:!1,profilePicture:!1}),O=t=>{o({...r,imageUrls:r.imageUrls.filter((s,a)=>a!==t)})},W=()=>{if(N.length>0&&N.length+r.imageUrls.length<7){p(!0),q(!1);const t=[];for(let s=0;s<N.length;s++)t.push(I(N[s]));Promise.all(t).then(s=>(o({...r,imageUrls:r.imageUrls.concat(s)}),q(!1),p(!1),c.success("Image uploaded successfully"))).catch(()=>{c.error("Image upload failed(2 mb max per image)"),p(!1)})}else c.error("you can only upload 6 images per provider"),p(!1)},I=async t=>new Promise((s,a)=>{const d=re(ie),b=new Date().getTime()+t.name,h=se(d,b),F=ae(h,t);F.on("state_changed",v=>{const te=v.bytesTransferred/v.totalBytes*100;console.log(`Upload is ${te} % done`)},v=>{a(v)},()=>{le(F.snapshot.ref).then(v=>{s(v)})})}),i=t=>{const{id:s,value:a,type:d}=t.target;["addressLine1","street","pincode"].includes(s)?o(h=>({...h,address:{...h.address,[s]:a}})):o(d==="time"?h=>({...h,availability:{...h.availability,[s]:a}}):{...r,[s]:a})},Y=async t=>{t.preventDefault();try{let s={...n};if(!r.profilePicture||r.profilePicture.length<1)return s.profilePicture=!0,u(s),c.error("You must upload a profile picture");if(s.profilePicture=!1,u(s),/\S+@\S+\.\S+/.test(r.email))s.email=!1,u(s);else return s.email=!0,u(s),c.error("Invalid email address");if(!r.phone||r.phone.length!==13)return s.phone=!0,u(s),c.error("Phone number must be 10 digits");if(s.phone=!1,u(s),!r.description||r.description.length<40)return s.description=!0,u(s),c.error("Description must be at least 40 characters");if(s.description=!1,u(s),!r.imageUrls||r.imageUrls.length<1)return s.imageUrls=!0,u(s),c.error("You must upload at least one image");s.imageUrls=!1,u(s),y(!0),x(!1);const d=await(await fetch("/server/provider/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,userRef:m._id})})).json();y(!1),d.success&&x(d.message),L(`/provider/${d._id}`),V(oe(d._id))}catch(s){x(s.message),y(!1)}},z=t=>{t.preventDefault(),D.current.click()},H=t=>{const s=t.target.files[0];s&&(p(!0),I(s).then(a=>{o({...r,profilePicture:a}),p(!1),c.success("Profile image uploaded successfully")}).catch(()=>{c.error("Profile image upload failed"),p(!1)}))},P=[{value:"Diagnostic Evaluation",label:"Diagnostic Evaluation"},{value:"Speech Therapy",label:"Speech Therapy"},{value:"ABA Therapy",label:"ABA Therapy"},{value:"Occupational Therapy",label:"Occupational Therapy"},{value:"School-Based Service",label:"School-Based Service"},{value:"Dance Movement",label:"Dance Movement"},{value:"Art as Therapy",label:"Art as Therapy"},{value:"Counselling",label:"Counselling"}],E=[{value:"Virtual",label:"Virtual"},{value:"In-Clinic",label:"In-Clinic"},{value:"In-Home",label:"In-Home"}],[U,J]=l.useState(),[Q,G]=l.useState([]);let K=A.getAllCountries();const[S,X]=l.useState(K[0]);let Z=ce.getStatesOfCountry(S.isoCode);l.useEffect(()=>{if(S&&U){const t=ue.getCitiesOfState(S.isoCode,U);G(t)}},[S,U]),l.useEffect(()=>{(async()=>{if(y(!0),!m)return;const a=await(await fetch(`/server/provider/fetchprovider/${m._id}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();$(a),y(!1),a.status===!0&&o({...r,...a.fetchprovider,name:a.fetchprovider.name.map(d=>P.find(b=>b.value===d).value),therapytype:a.fetchprovider.therapytype.map(d=>E.find(b=>b.value===d).value),address:{...r.address,addressLine1:a.fetchprovider.address.addressLine1,street:a.fetchprovider.address.street,country:a.fetchprovider.address.country,state:a.fetchprovider.address.state,city:a.fetchprovider.address.city,pincode:a.fetchprovider.address.pincode}})})()},[m]);const ee=async t=>{t.preventDefault();try{if(r.imageUrls.length<1)return c.error("You must upload at least one image");x(!1);const a=await(await fetch(`/server/provider/update/${f.fetchprovider._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,userRef:m._id})})).json();a.success&&x(a.message),c.success("Provider updated successfully")}catch(s){x(s.message)}};return e.jsx("div",{className:"md:p-10 p-5 w-full mx-auto flex-col items-center bg-sky-100",children:g?e.jsx(e.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh"},children:e.jsx(me,{color:"#AFDBD8",loading:g,size:20})})}):e.jsxs(e.Fragment,{children:[m._id===(f&&f.fetchprovider&&f.fetchprovider.userRef)?e.jsx(e.Fragment,{children:e.jsxs("h1",{className:"flex flex-col p-2 font-bold text-2xl text-gray",children:[" ","Your Provider Details :"]})}):e.jsx(e.Fragment,{children:e.jsx("h1",{className:"text-base text-gray-700 font-semibold text-left my-7 mt-5",children:"Fill the form to create a provider"})}),e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:D,hidden:!0,accept:"image/*",required:!0,onChange:H}),e.jsx("div",{className:"relative w-24 h-24 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:z,children:[e.jsx("img",{src:r.profilePicture||"https://i.ibb.co/tKQH4zp/defaultprofile.jpg",alt:"profile",className:`w-24 h-24 rounded-full object-cover border-4 border-[lightgray] ${n.profilePicture&&"border-red-500"}`}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-8 h-8"}),e.jsx("p",{className:"text-white text-xs",children:"Choose Profile"})]})]})}),e.jsx("div",{className:"w-full flex justify-center mt-2",children:n.profilePicture&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please upload a profile picture"})}),e.jsx("div",{className:"bg-white",children:e.jsxs("form",{onSubmit:Y,className:"flex flex-col sm:flex-row gap-10 mt-6 md:p-20 p-6 rounded-lg mx-auto",children:[e.jsxs("div",{className:"flex flex-col gap-3 flex-1",children:[e.jsx("label",{className:"font-semibold text-main",children:"Select service*"}),e.jsx(j,{id:"name",options:P,isMulti:!0,required:!0,placeholder:"What service do you provide?",touchUi:!1,className:"border-2 p-1 rounded-lg border-slate-300 input hover:border-purple-400",defaultValue:Array.isArray(r.name)?r.name.map(t=>P.find(s=>s.value===t)):[],onChange:t=>{o(s=>({...s,name:t.map(a=>a.value)}))},styles:{control:t=>({...t,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},r.name),e.jsx("label",{className:"font-semibold text-main",children:"Full Name*"}),e.jsx("input",{type:"text",placeholder:"Full Name",className:"border-2 p-2 rounded-lg border-slate-300 input focus:outline-none focus:ring-0",id:"fullName",required:!0,onChange:i,value:r.fullName}),e.jsx("label",{className:"font-semibold text-main",children:e.jsxs("p",{className:"flex flex-row items-center",children:[n.email&&e.jsx(_,{className:"text-red-700 text-sm"}),"Email*"," "]})}),e.jsx("input",{placeholder:"Email",className:`border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300 ${n.email?"error":""}`,id:"email",required:!0,onChange:i,value:r.email}),n.email&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please enter a valid email address."}),e.jsx("label",{className:"font-semibold text-main",children:"Qualification*"}),e.jsx("input",{type:"text",placeholder:"(e.g.,Psychologist, Counselor)",className:"border-2 p-2 rounded-lg input focus:ring-0 border-slate-300",id:"qualification",required:!0,onChange:i,value:r.qualification}),e.jsx("label",{className:"font-semibold text-main",children:"Address*"}),e.jsx("input",{placeholder:"Address",className:"border-2 p-2 rounded-lg border-slate-300 input focus:outline-none focus:ring-0 ",id:"addressLine1",required:!0,onChange:i,value:r.address.addressLine1}),e.jsx("label",{className:"font-semibold text-main",children:"Street"}),e.jsx("input",{placeholder:"Street",className:"w-full border-2 p-2 rounded-lg border-slate-300 input focus:outline-none focus:ring-0 ",id:"street",onChange:i,value:r.address.street}),e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"Country*"}),e.jsx(j,{id:"country",placeholder:"Country",defaultValue:r.address.country?{value:r.address.country,label:r.address.country}:void 0,options:A.getAllCountries().map(t=>({value:t.name,label:t.name})),className:"w-full rounded-lg border-2 border-slate-300 hover:border-purple-400",onChange:t=>{const s=A.getAllCountries().find(a=>a.name===t.value);X(s),o({...r,address:{...r.address,country:t.label}})},styles:{control:t=>({...t,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},r.address.country)]}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"State*"}),e.jsx(j,{id:"state",defaultValue:r.address.state?{value:r.address.state,label:r.address.state}:void 0,options:Z.map(t=>({value:t.isoCode,label:t.name})),placeholder:"State",className:"w-full rounded-lg border-2 border-slate-300 hover:border-purple-400",onChange:t=>{J(t.value),o({...r,address:{...r.address,state:t.label}})},styles:{control:t=>({...t,backgroundColor:"transparent",minWidth:"100px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},`state-${r.address.state}`)]})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"City*"}),e.jsx(j,{id:"city",defaultValue:r.address.city?{value:r.address.city,label:r.address.city}:void 0,options:Q.map(t=>({value:t.name,label:t.name})),className:"w-full border-2 rounded-lg border-slate-300 hover:border-purple-400",placeholder:"Select City",onChange:t=>{o({...r,address:{...r.address,city:t.label}})},styles:{control:t=>({...t,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},r.address.city)]}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"Pincode*"}),e.jsx("input",{placeholder:"Pincode",className:"w-full border-2 p-1.5 border-slate-300 rounded-lg input focus:outline-none focus:ring-0",id:"pincode",required:!0,onChange:i,value:r.address.pincode})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold text-main md:text-base text-sm",children:"fee per Appoinment*"}),e.jsx("input",{type:"number",id:"regularPrice",min:"50",max:"100000",required:!0,className:"border-2 p-3 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",onChange:i,value:r.regularPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{className:"text-main md:text-sm text-xs font-semibold",children:"Regular Fees"}),e.jsx("span",{className:"text-main font-semibold text-xs",children:"( ₹ Appointment )"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold text-main md:text-base text-sm",children:"Years of Experience*  "}),e.jsx("input",{type:"number",id:"experience",min:"0",max:"100000",required:!0,className:"border-2 p-3 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",onChange:i,value:r.experience}),e.jsxs("div",{className:"flex flex-col items-center ",children:[e.jsx("p",{className:"text-main md:text-sm text-xs font-semibold",children:"Service"}),e.jsx("span",{className:"text-main font-semibold text-xs",children:"( no. of Experience )"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col flex-1 gap-3",children:[e.jsxs("p",{className:"font-semibold text-main",children:["Explain About your therapy section*",e.jsx("span",{className:"text-sm",children:"  (40 minimum words)"})]}),e.jsx("textarea",{type:"text",placeholder:"Now is the chance to show your future clients that your approach to therapy will make a real difference!",rows:5,className:`border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300 ${n.description?"error":""}`,id:"description",required:!0,onChange:i,value:r.description}),n.description&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please write a 40-word description in the field."}),e.jsx("label",{className:"font-semibold text-main",children:"Select your therapy type*"}),e.jsx(j,{id:"therapytype",options:E,isMulti:!0,required:!0,placeholder:"Type of Therapy",touchUi:!1,defaultValue:Array.isArray(r.therapytype)?r.therapytype.map(t=>E.find(s=>s.value===t)):[],className:"border-2 p-1 rounded-lg border-slate-300 bg-white input hover:border-purple-400",onChange:t=>{o(s=>({...s,therapytype:t.map(a=>a.value)}))},styles:{control:t=>({...t,backgroundColor:"transparent",minWidth:"160px",border:"none",boxShadow:"none",transition:"all 0.3s ease"})}},r.therapytype),e.jsx("label",{className:"font-semibold text-main",children:"Licensing*"}),e.jsx("input",{type:"text",placeholder:"(License number, issuing authority)",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",id:"license",required:!0,onChange:i,value:r.license}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:e.jsxs("p",{className:"flex flex-row items-center",children:[n.phone&&e.jsx(_,{className:"text-red-700 text-sm"}),"Phone*"]})}),e.jsx(fe,{placeholder:"Phone number",className:`border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300 ${n.phone?"error":""}`,id:"phone",required:!0,onChange:t=>{M(t),o({...r,phone:t})},value:r.phone}),n.phone&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please enter a 10-digit number."}),e.jsx("p",{className:"font-semibold text-main",children:"Availability:"}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("p",{className:"font-semibold text-main",children:"Morning:"}),e.jsx("input",{type:"time",id:"morningStart",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:r.availability.morningStart,onChange:i}),e.jsx("input",{type:"time",id:"morningEnd",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:r.availability.morningEnd,onChange:i})]}),e.jsxs("div",{className:"flex flex-row gap-4 pl-1",children:[e.jsx("p",{className:"font-semibold text-main",children:"Evening:"}),e.jsx("input",{type:"time",id:"eveningStart",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:r.availability.eveningStart,onChange:i}),e.jsx("input",{type:"time",id:"eveningEnd",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:r.availability.eveningEnd,onChange:i})]})]}),e.jsxs("p",{className:"font-semibold text-main",children:["Images:",e.jsx("span",{className:"font-normal text-gray-600 ml-2",children:"The first image will be the cover. pick image for showcase (max 6)"})]}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx(pe,{onChange:t=>R(t.target.files),className:"p-3 rounded w-full",type:"file",id:"images",accept:"image/*",multiple:!0}),e.jsx("button",{type:"button",disabled:C,onClick:W,className:`p-2 max-h-10 text-green-700 border border-green-700 rounded uppercase hover:shadow-lg disabled:opacity-85 ${n.imageUrls&&"error"}`,children:C?"uploading...":"upload"})]}),e.jsx("div",{className:"",children:n.imageUrls&&e.jsxs("p",{className:"text-sm text-red-500 font-semibold",children:[" ","Please upload at least one image."]})}),e.jsx("p",{className:"text-red-700 text-xs",children:T&&T}),r.imageUrls.length>0&&r.imageUrls.map((t,s)=>e.jsxs("div",{className:"flex justify-between p-3 border items-center",children:[e.jsx("img",{src:t,alt:"image",className:"w-20 h-20 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>O(s),className:"p-3 text-red-700 rounded-lg uppercase hover:opacity-75",children:"Delete"})]},s)),m._id===(f&&f.fetchprovider&&f.fetchprovider.userRef)?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"submit",onClick:ee,disabled:g||C,className:"p-3 bg-blue-600 text-white rounded=lg rounded-lg Captialize hover:opacity-95 disabled:opacity-80 transition-all duration-300 ease-in-out",children:g?"Saving...":"Save Changes"}),w&&e.jsx("p",{className:"text-red-700 text-xs",children:w})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"submit",disabled:g||C,className:"p-3 btn-color rounded-lg font-semibold  rounded=lg hover:opacity-85 disabled:opacity-80 transition-all duration-300 ease-in-out",children:g?"Creating Provider":"Create Provider"}),w&&e.jsx("p",{className:"text-red-700 text-xs",children:w})]})]})]})})]})})}export{ft as default};
