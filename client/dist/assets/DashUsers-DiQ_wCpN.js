import{a as k,r as t,j as e,T as a,aK as p,aL as N,M as h,aM as v,B as u}from"./index-D_9v8cF4.js";function D(){const{currentUser:o}=k(s=>s.user),[n,d]=t.useState([]),[j,x]=t.useState(!0),[g,c]=t.useState(!1),[m,f]=t.useState(""),[w,y]=t.useState(!0);console.log("CurrentUser",o),t.useEffect(()=>{const s=async()=>{try{const r=await fetch("/server/user/getusers"),l=await r.json();r.ok&&(d(l.users),y(!1),l.users.length<9&&x(!1))}catch(r){console.log(r.message)}};o.isAdmin&&s()},[o.isAdmin]);const C=async()=>{const s=n.length;try{const r=await fetch(`/server/user/getusers?startIndex=${s}`),l=await r.json();r.ok&&(d(i=>[...i,...l.users]),l.users.length<9&&x(!1))}catch(r){console.log(r.message)}},b=async()=>{try{const s=await fetch(`/server/user/delete/${m}`,{method:"DELETE"}),r=await s.json();s.ok?(d(l=>l.filter(i=>i._id!==m)),c(!1)):console.log(r.message)}catch(s){console.log(s.message)}};return e.jsxs("div",{className:"table-auto overflow-x-scroll md:mx-auto p-3 scrollbar scrollbar-track-slate-100 scrollbar-thumb-slate-300 dark:scrollbar-track-slate-700 dark:scrollbar-thumb-slate-500 ",children:[w?e.jsx("p",{children:"Loading Users..."}):o.isAdmin&&n.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(a,{hoverable:!0,className:"shadow-md w-full",children:[e.jsxs(a.Head,{children:[e.jsx(a.HeadCell,{children:"Date created"}),e.jsx(a.HeadCell,{children:"User image"}),e.jsx(a.HeadCell,{children:"Username"}),e.jsx(a.HeadCell,{children:"Email"}),e.jsx(a.HeadCell,{children:"Admin"}),e.jsx(a.HeadCell,{children:"Delete"})]}),n.map(s=>e.jsx(a.Body,{className:"divide-y",children:e.jsxs(a.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(a.Cell,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(a.Cell,{children:e.jsx("img",{src:s.profilePicture,alt:s.username,className:"w-10 h-10 object-cover bg-gray-500 rounded-full"})}),e.jsx(a.Cell,{children:s.username}),e.jsx(a.Cell,{children:s.email}),e.jsx(a.Cell,{children:s.isAdmin?e.jsx(p,{className:"text-green-500"}):e.jsx(N,{className:"text-red-500"})}),e.jsx(a.Cell,{children:e.jsx("span",{onClick:()=>{c(!0),f(s._id)},className:"font-medium text-red-500 hover:underline cursor-pointer",children:"Delete"})})]})},s._id))]}),j&&e.jsx("button",{onClick:C,className:"w-full text-teal-500 self-center text-sm py-7",children:"Show more"})]}):e.jsx("p",{children:"You have no users yet!"}),e.jsxs(h,{show:g,onClose:()=>c(!1),popup:!0,size:"md",children:[e.jsx(h.Header,{}),e.jsx(h.Body,{children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-14 w-14 text-gray-400 dark:text-gray-200 mb-4 mx-auto"}),e.jsx("h3",{className:"mb-5 text-lg text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this user?"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(u,{color:"failure",onClick:b,children:"Yes, I'm sure"}),e.jsx(u,{color:"gray",onClick:()=>c(!1),children:"No, cancel"})]})]})})]})]})}export{D as default};
