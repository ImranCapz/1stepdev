import{j as e,r as t}from"./react-DiIsFRGf.js";import{u as T,a as ae}from"./react-redux-Cmcgb_ry.js";import{O as re,N as te,a as O,u as B}from"./react-router-Ck6p_Z-K.js";import{c as y,d as l,M as q,B as _}from"./flowbite-react-moIAvRiJ.js";import{u as le,v as F,w as oe,x as ne,y as ie,z as ce,A as de,B as ue}from"./react-icons-4Z_jIp8v.js";import{L as A}from"./react-router-dom-Cj7EZRaW.js";import{e as me}from"./Header.jsx-DRWgs81u.js";import{_ as he}from"./react-countup-uwXQ9Xr-.js";import{g as pe,r as fe,u as ge,a as xe}from"./@firebase-ZU7arh2v.js";import{b as be}from"./CreateProvider.jsx-CujhAS3a.js";import{_ as w}from"./react-hot-toast-BDpxPdYe.js";import{S as U}from"./react-select-xtze-_c4.js";import{S as je,C as ve,a as L}from"./country-state-city-B5NRDuuX.js";function Me(){const{currentUser:u}=T(n=>n.user);return u.isAdmin?e.jsx(re,{}):e.jsx(te,{to:"/"})}function ye(){const u=O(),[n,p]=t.useState(""),g=ae(),h=B();t.useEffect(()=>{const d=new URLSearchParams(u.search).get("tab");d&&p(d)},[u.search]);const x=async()=>{try{const i=await fetch("/server/auth/signout",{method:"GET"}),d=await i.json();i.ok?(g(me()),h("/")):console.log(d.message)}catch(i){console.log(i.message)}};return e.jsx(y,{className:"w-full md:w-56",children:e.jsx(y.Items,{children:e.jsxs(y.ItemGroup,{className:"flex flex-col gap-2",children:[e.jsx(A,{to:"/admin-dashboard?tab=dashboard",children:e.jsx(y.Item,{active:n==="dashboard",icon:le,label:"Admin",labelColor:"light",as:"div",children:"Dashboard"})}),e.jsx(A,{to:"/admin-dashboard?tab=users",children:e.jsx(y.Item,{active:n==="users",icon:F,labelColor:"light",as:"div",children:"Users"})}),e.jsx(A,{to:"/admin-dashboard?tab=createprovider",children:e.jsx(y.Item,{active:n==="createprovider",icon:F,labelColor:"light",as:"div",children:"Provider"})}),e.jsx(y.Item,{icon:oe,className:"cursor-pointer",onClick:x,children:"Sign Out"})]})})})}function $(){const{currentUser:u}=T(s=>s.user),[n,p]=t.useState([]),[g,h]=t.useState(!0),[x,i]=t.useState(!1),[d,f]=t.useState(""),[j,C]=t.useState(!0);console.log("CurrentUser",u),t.useEffect(()=>{const s=async()=>{try{const o=await fetch("/server/user/getusers"),b=await o.json();o.ok&&(p(b.users),C(!1),b.users.length<9&&h(!1))}catch(o){console.log(o.message)}};u.isAdmin&&s()},[u.isAdmin]);const D=async()=>{const s=n.length;try{const o=await fetch(`/server/user/getusers?startIndex=${s}`),b=await o.json();o.ok&&(p(S=>[...S,...b.users]),b.users.length<9&&h(!1))}catch(o){console.log(o.message)}},P=async()=>{try{const s=await fetch(`/server/user/delete/${d}`,{method:"DELETE"}),o=await s.json();s.ok?(p(b=>b.filter(S=>S._id!==d)),i(!1)):console.log(o.message)}catch(s){console.log(s.message)}};return e.jsxs("div",{className:"table-auto overflow-x-scroll md:mx-auto p-3 scrollbar scrollbar-track-slate-100 scrollbar-thumb-slate-300 dark:scrollbar-track-slate-700 dark:scrollbar-thumb-slate-500 ",children:[j?e.jsx("p",{children:"Loading Users..."}):u.isAdmin&&n.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(l,{hoverable:!0,className:"shadow-md w-full",children:[e.jsxs(l.Head,{children:[e.jsx(l.HeadCell,{children:"Date created"}),e.jsx(l.HeadCell,{children:"User image"}),e.jsx(l.HeadCell,{children:"Username"}),e.jsx(l.HeadCell,{children:"Email"}),e.jsx(l.HeadCell,{children:"Admin"}),e.jsx(l.HeadCell,{children:"Delete"})]}),n.map(s=>e.jsx(l.Body,{className:"divide-y",children:e.jsxs(l.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(l.Cell,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(l.Cell,{children:e.jsx("img",{src:s.profilePicture,alt:s.username,className:"w-10 h-10 object-cover bg-gray-500 rounded-full"})}),e.jsx(l.Cell,{children:s.username}),e.jsx(l.Cell,{children:s.email}),e.jsx(l.Cell,{children:s.isAdmin?e.jsx(ne,{className:"text-green-500"}):e.jsx(ie,{className:"text-red-500"})}),e.jsx(l.Cell,{children:e.jsx("span",{onClick:()=>{i(!0),f(s._id)},className:"font-medium text-red-500 hover:underline cursor-pointer",children:"Delete"})})]})},s._id))]}),g&&e.jsx("button",{onClick:D,className:"w-full text-teal-500 self-center text-sm py-7",children:"Show more"})]}):e.jsx("p",{children:"You have no users yet!"}),e.jsxs(q,{show:x,onClose:()=>i(!1),popup:!0,size:"md",children:[e.jsx(q.Header,{}),e.jsx(q.Body,{children:e.jsxs("div",{className:"text-center",children:[e.jsx(ce,{className:"h-14 w-14 text-gray-400 dark:text-gray-200 mb-4 mx-auto"}),e.jsx("h3",{className:"mb-5 text-lg text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this user?"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(_,{color:"failure",onClick:P,children:"Yes, I'm sure"}),e.jsx(_,{color:"gray",onClick:()=>i(!1),children:"No, cancel"})]})]})})]})]})}const Re=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));function Ne(){const{currentUser:u}=T(d=>d.user),[n,p]=t.useState([]),[g,h]=t.useState(0),[x,i]=t.useState(0);return t.useEffect(()=>{const d=async()=>{try{const f=await fetch("/server/user/getusers?limit=5"),j=await f.json();f.ok&&(p(j.users),h(j.totalUsers),i(j.lastMonthUsers))}catch(f){console.log(f.message)}};u.isAdmin&&d()},[u]),e.jsxs("div",{className:"p-3 md:mx-auto",children:[e.jsxs("div",{className:"flex flex-col p-3 bg-sky-200 gap-4 md:w-72 w-full rounded-md shadow-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"",children:[e.jsx("h3",{className:"text-gray-500 font-semibold text-md uppercase",children:"Total Users"}),e.jsxs("p",{className:"text-2xl",children:[" ",e.jsx(he,{end:g,duration:1})]})]}),e.jsx(de,{className:"bg-sky-500 text-white rounded-full text-5xl p-3"})]}),e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsxs("span",{className:"text-green-500 flex items-center",children:[e.jsx(ue,{}),x]}),e.jsx("div",{className:"text-gray-500 ",children:"Last Month"})]})]}),e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex flex-col w-full md:w-auto shadow-md p-2 rounded-lg ",children:[e.jsxs("div",{className:"flex justify-between p-3 text-sm font font-semibold",children:[e.jsx("h1",{className:"text-center p-2",children:"Recent Users"}),e.jsx(_,{children:e.jsx(A,{to:"/admin-dashboard?tab=users",children:"See all"})})]}),e.jsxs(l,{hoverable:!0,children:[e.jsxs(l.Head,{children:[e.jsx(l.HeadCell,{children:"User Image"}),e.jsx(l.HeadCell,{children:"Email"})]}),n&&n.map(d=>e.jsx(l.Body,{className:"divide-y",children:e.jsxs(l.Row,{className:"bg-white",children:[e.jsx(l.Cell,{children:e.jsx("img",{src:d.profilePicture,alt:"user profile picture",className:"w-10 h-10 rounded-full"})}),e.jsx(l.Cell,{children:d.email})]})},d._id))]})]})})]})}function we(){const{currentUser:u}=T(a=>a.user),[n,p]=t.useState([]),[g,h]=t.useState(""),[x,i]=t.useState(!1),[d,f]=t.useState(!1),[j,C]=t.useState(!1),D=B(),P=t.useRef(null),[s,o]=t.useState({imageUrls:[],name:"",email:"",qualification:"",license:"",fullName:"",experience:"",phone:"",address:{addressLine1:"",country:"",state:"",city:"",street:"",pincode:""},therapytype:"",availability:{morningStart:"08:00",morningEnd:"12:00",eveningStart:"13:00",eveningEnd:"17:00"},regularPrice:"",description:"",profilePicture:""}),b=a=>{o({...s,imageUrls:s.imageUrls.filter((r,c)=>c!==a)})},S=()=>{if(n.length>0&&n.length+s.imageUrls.length<7){i(!0),h(!1);const a=[];for(let r=0;r<n.length;r++)a.push(H(n[r]));Promise.all(a).then(r=>(o({...s,imageUrls:s.imageUrls.concat(r)}),h(!1),i(!1),w.success("Image uploaded successfully"))).catch(()=>{w.error("Image upload failed(2 mb max per image)"),i(!1)})}else w.error("you can only upload 6 images per provider"),i(!1)},H=async a=>new Promise((r,c)=>{const I=pe(be),M=new Date().getTime()+a.name,v=fe(I,M),R=ge(v,a);R.on("state_changed",N=>{const se=N.bytesTransferred/N.totalBytes*100;console.log(`Upload is ${se} % done`)},N=>{c(N)},()=>{xe(R.snapshot.ref).then(N=>{r(N)})})}),m=a=>{const{id:r,value:c,type:I}=a.target;["addressLine1","street","pincode"].includes(r)?o(v=>({...v,address:{...v.address,[r]:c}})):o(I==="time"?v=>({...v,availability:{...v.availability,[r]:c}}):{...s,[r]:c})},z=async a=>{a.preventDefault();try{if(s.imageUrls.length<1)return w.error("You must upload at least one image");C(!0),f(!1);const c=await(await fetch("/server/provider/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,userRef:u._id})})).json();C(!1),c.success&&f(c.message),D(`/provider/${c._id}`)}catch(r){f(r.message),C(!1)}},Y=a=>{a.preventDefault(),P.current.click()},G=a=>{const r=a.target.files[0];r&&(i(!0),H(r).then(c=>{o({...s,profilePicture:c}),i(!1),w.success("Profile image uploaded successfully")}).catch(()=>{w.error("Profile image upload failed"),i(!1)}))},W=[{value:"Diagnostic Evaluation",label:"Diagnostic Evaluation"},{value:"Speech Therapy",label:"Speech Therapy"},{value:"ABA Therapy",label:"ABA Therapy"},{value:"Occupational Therapy",label:"Occupational Therapy"},{value:"School-Based Service",label:"School-Based Service"},{value:"Dance Movement",label:"Dance Movement"},{value:"Art as Therapy",label:"Art as Therapy"},{value:"Counselling",label:"Counselling"}],Q=[{value:"Virtual",label:"Virtual"},{value:"In-Clinic",label:"In-Clinic"},{value:"In-Home",label:"In-Home"}],[E,V]=t.useState(),[J,K]=t.useState([]);let X=L.getAllCountries();const[k,Z]=t.useState(X[0]);let ee=je.getStatesOfCountry(k.isoCode);return t.useEffect(()=>{if(k&&E){const a=ve.getCitiesOfState(k.isoCode,E);K(a)}},[k,E]),e.jsxs("div",{className:"md:p-10 p-2 w-full mx-auto flex-col items-center",children:[e.jsx("h1",{className:"text-base text-gray-700 font-semibold text-left my-7 mt-5",children:"Fill the form to create a provider"}),e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:P,hidden:!0,accept:"image/*",required:!0,onChange:G}),e.jsx("div",{className:"relative w-24 h-24 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:Y,children:[e.jsx("img",{src:s.profilePicture||"https://i.ibb.co/tKQH4zp/defaultprofile.jpg",alt:"profile",className:"w-24 h-24 rounded-full object-cover border-4 border-[lightgray]"}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-8 h-8"}),e.jsx("p",{className:"text-white text-xs",children:"Choose Profile"})]})]})}),e.jsxs("form",{onSubmit:z,className:"flex flex-col sm:flex-row gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsx(U,{id:"name",options:W,isMulti:!0,required:!0,placeholder:"What service do you provide?",touchUi:!1,className:"border-2 p-3 rounded-lg border-slate-500 focus:border-amber-700  hover:border-amber-500",onChange:a=>{o(r=>({...r,name:a.map(c=>c.value)}))},styles:{control:a=>({...a,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}}),e.jsx("input",{type:"text",placeholder:"Full Name*",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",id:"fullName",required:!0,onChange:m,value:s.fullName}),e.jsx("input",{type:"email",placeholder:"Email",className:"border-2 p-3 rounded-lg focus:border-amber-600 focus:ring-0",id:"email",required:!0,onChange:m,value:s.email}),e.jsx("input",{type:"text",placeholder:"Qualification(e.g.,Psychologist, Counselor)",className:"border-2 p-3 rounded-lg focus:border-amber-600 focus:ring-0",id:"qualification",required:!0,onChange:m,value:s.qualification}),e.jsx("input",{type:"text",placeholder:"Licensing (License number, issuing authority)",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",id:"license",required:!0,onChange:m,value:s.license}),e.jsx("input",{placeholder:"Address Line 1",className:"border-2 p-3 rounded-lg border-slate-500 focus:border-amber-700 focus:outline-none focus:ring-0",id:"addressLine1",required:!0,onChange:m,value:s.address.addressLine1}),e.jsx("input",{placeholder:"Street",className:"w-full border-2 p-3 rounded-lg border-slate-500 focus:border-amber-700 focus:outline-none focus:ring-0",id:"street",required:!0,onChange:m,value:s.address.street}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(U,{id:"country",options:L.getAllCountries().map(a=>({value:a.name,label:a.name})),className:"w-full rounded-lg border-2 border-slate-500",placeholder:"Select Country",onChange:a=>{const r=L.getAllCountries().find(c=>c.name===a.value);Z(r),o({...s,address:{...s.address,country:a.label}})}}),e.jsx(U,{id:"state",options:ee.map(a=>({value:a.isoCode,label:a.name})),placeholder:"Select State",className:"w-full rounded-lg border-2 border-slate-500",onChange:a=>{console.log("State select onChange triggered",a),V(a.value),o({...s,address:{...s.address,state:a.label}})}})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(U,{id:"city",options:J.map(a=>({value:a.name,label:a.name})),className:"w-full border-2 rounded-lg border-slate-500",placeholder:"Select City",onChange:a=>{o({...s,address:{...s.address,city:a.label}})}}),e.jsx("input",{placeholder:"Pincode",className:"w-full border-2 p-1 border-slate-500 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",id:"pincode",required:!0,onChange:m,value:s.address.pincode})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"regularPrice",min:"50",max:"100000",required:!0,className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",onChange:m,value:s.regularPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{children:"Regular Fees"}),e.jsx("span",{className:"text-xs",children:"( â‚¹ per Appointment )"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"experience",min:"0",max:"100000",required:!0,className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",onChange:m,value:s.experience}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{children:"Year of Experience"}),e.jsx("span",{className:"text-xs",children:"( services )"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col flex-1 gap-4",children:[e.jsx(U,{id:"therapytype",options:Q,isMulti:!0,required:!0,placeholder:"Type of Therapy",touchUi:!1,className:"border-2 p-3 rounded-lg border-slate-500 bg-white focus:border-amber-700 hover:border-amber-500",onChange:a=>{o(r=>({...r,therapytype:a.map(c=>c.value)}))},styles:{control:a=>({...a,backgroundColor:"transparent",minWidth:"160px",border:"none",boxShadow:"none",transition:"all 0.3s ease"})}}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("input",{type:"number",placeholder:"Phone number",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",id:"phone",required:!0,onChange:m,value:s.phone}),e.jsx("p",{className:"font-semibold",children:"Availability:"}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("p",{children:"Morning:"}),e.jsx("input",{type:"time",id:"morningStart",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",required:!0,value:s.availability.morningStart,onChange:m}),e.jsx("input",{type:"time",id:"morningEnd",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",required:!0,value:s.availability.morningEnd,onChange:m})]}),e.jsxs("div",{className:"flex flex-row gap-4 pl-1",children:[e.jsx("p",{children:"Evening:"}),e.jsx("input",{type:"time",id:"eveningStart",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",required:!0,value:s.availability.eveningStart,onChange:m}),e.jsx("input",{type:"time",id:"eveningEnd",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",required:!0,value:s.availability.eveningEnd,onChange:m})]})]}),e.jsx("textarea",{type:"text",placeholder:"Biography",className:"border-2 p-3 rounded-lg focus:border-amber-700 focus:outline-none focus:ring-0",id:"description",required:!0,onChange:m,value:s.description}),e.jsxs("p",{className:"font-semibold",children:["Images:",e.jsx("span",{className:"font-normal text-gray-600 ml-2",children:"The first image will be the cover. pick image for showcase (max 6)"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{onChange:a=>p(a.target.files),className:"p-3 border border-gray-300 rounded w-full",type:"file",id:"images",accept:"image/*",multiple:!0}),e.jsx("button",{type:"button",disabled:x,onClick:S,className:"p-3 text-green-700 border border-green-700 rounded uppercase hover:shadow-lg disabled:opacity-85",children:x?"uploading...":"upload"})]}),e.jsx("p",{className:"text-red-700 text-xs",children:g&&g}),s.imageUrls.length>0&&s.imageUrls.map((a,r)=>e.jsxs("div",{className:"flex justify-between p-3 border items-center",children:[e.jsx("img",{src:a,alt:"image",className:"w-20 h-20 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>b(r),className:"p-3 text-red-700 rounded-lg uppercase hover:opacity-75",children:"Delete"})]},r)),e.jsx("button",{disabled:j||x,className:"p-3 bg-slate-700 text-white rounded=lg uppercase hover:opacity-95 disabled:opacity-80",children:j?"Creating Provider":"Create Provider"}),d&&e.jsx("p",{className:"text-red-700 text-xs",children:d})]})]})]})}function Ce(){const u=O(),[n,p]=t.useState("");return t.useEffect(()=>{const h=new URLSearchParams(u.search).get("tab");h&&p(h)},[u.search]),e.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row ",children:[e.jsx("div",{className:"md:w-56",children:e.jsx(ye,{})}),e.jsx("div",{children:n==="dashboard"&&e.jsx(Ne,{})}),n==="users"&&e.jsx($,{}),n==="createprovider"&&e.jsx(we,{})]})}const Fe=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"}));export{Me as A,Re as D,Fe as a};
