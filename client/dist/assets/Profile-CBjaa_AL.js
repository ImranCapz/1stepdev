import{G as M,r as t,a as O,b as q,j as e,i as A,Y as G,Z as Y,L as b,Q as z,X as H,m as J,n as v,q as Q,_ as W}from"./index-Bn1Unxpt.js";import{g as X,r as Z,u as K,a as ee}from"./index.esm2017-YoxVar0B.js";import{b as se}from"./index-g5ccCoVz.js";import{a as te}from"./index-C8kgQJcn.js";function re(c){return M({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(c)}function ie(){const c=t.useRef(null),[x,y]=t.useState(),[d,S]=t.useState(0),[P,C]=t.useState(!1),[l,w]=t.useState({profilePicture:"",password:""}),m=t.useRef(null),[E,k]=t.useState(!1),[g,U]=t.useState(!1),[D,h]=t.useState(!1),[p,N]=t.useState([]),{currentUser:o,loading:_,error:F}=O(s=>s.user),n=q();t.useEffect(()=>{x&&I(x)},[x]);const I=async s=>{const r=X(H),a=new Date().getTime()+s.name,j=Z(r,a),u=K(j,s);u.on("state_changed",i=>{const V=i.bytesTransferred/i.totalBytes*100;S(Math.round(V))},i=>{C(!0)},()=>{ee(u.snapshot.ref).then(i=>w({...l,profilePicture:i}))})},R=s=>{s.preventDefault(),c.current.click()},L=async s=>{s.preventDefault();try{m.current.continuousStart(50),n(J());const a=await(await fetch(`/server/user/update/${o._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();if(a.success===!1){n(v(a));return}n(Q(a)),k(!0)}catch(r){n(v(r))}finally{m.current.complete()}},f=s=>{w({...l,[s.target.id]:s.target.value})},T=async()=>{try{h(!1);const r=await(await fetch(`/server/user/providers/${o._id}`)).json();if(r.success===!1){h(!0);return}N(r)}catch{h(!0)}},$=async s=>{try{const a=await(await fetch(`/server/provider/delete/${s}`,{method:"DELETE"})).json();if(a.success===!1)return console.log(a),W.success("Provider Deleted Successfully");N(j=>j.filter(u=>u._id!==s))}catch(r){console.log(r.message)}},B=()=>{U(!g)};return e.jsxs("div",{className:"bg-slate-100 p-3 mx-auto",children:[e.jsx(A,{ref:m,color:"#ff9900",height:3}),e.jsxs("h1",{className:"flex flex-col p-2 mb-4 font-bold text-2xl text-gray",children:["Account Settings :"," "]}),e.jsxs("div",{className:"p-10 bg-white rounded-lg border",children:[e.jsx("div",{className:"",children:e.jsxs("form",{className:"flex flex-col items-start gap-7 md:w-[900px]",onSubmit:L,children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:c,hidden:!0,accept:"image/*",onChange:s=>y(s.target.files[0])}),e.jsx("div",{className:"relative w-34 h-34 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:R,children:[e.jsx("img",{src:l.profilePicture||o.profilePicture,alt:"profile",className:"w-32 h-32 rounded-full object-cover border-4 border-[lightgray]"}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-10 h-10"}),e.jsx("p",{className:"text-white text-xs",children:"Change Picture"})]})]})}),e.jsx("p",{className:"text-sm self-center",children:P?e.jsx("span",{className:"text-red-500",children:"Please upload a valid image"}):d>0&&d<100?e.jsx("span",{children:`Uploading: ${d}%`}):d===100?e.jsx("span",{className:"text-green-700",children:"Image Uploaded Successfully"}):""})]}),e.jsxs("div",{className:"flex flex-col md:w-1/2 gap-2 relative",children:[e.jsx("label",{htmlFor:"username",className:"text-xl text-slate-600",children:"Username"}),e.jsxs("div",{className:"flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(G,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{defaultValue:o.username,type:"text",id:"username",required:!0,placeholder:"username",className:"flex-grow text-xl pl-3 text-gray-800 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:f})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Email Address"}),e.jsxs("div",{className:"flex items-center mt-2 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(re,{className:"ml-3 text-xls w-5 h-5 text-gray-400"}),e.jsx("input",{defaultValue:o.email,type:"email",id:"email",placeholder:"email",className:"flex-grow text-xl pl-3 w-3/4 mx-auto text-gray-500 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:f,disabled:!0})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Password"}),e.jsxs("div",{className:"relative flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(te,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{type:g?"text":"password",id:"password",placeholder:"password",className:"flex-grow text-xl pl-3 text-gray-700 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:f})]}),l.password&&e.jsx("div",{className:"absolute right-0 bottom-[127px] pr-5",children:e.jsx("button",{type:"button",onClick:B,children:g?e.jsx(Y,{className:"text-slate-700"}):e.jsx(se,{className:"text-slate-600"})})}),e.jsxs("h1",{className:"text-slate-500 font-semibold",children:[e.jsx("b",{children:"Note"}),": Enter new password for reset old password."]}),e.jsx("button",{className:"bg-blue-600 text-xl font-semibold text-white mt-6 p-3 rounded-lg hover:opacity-95 transition-all disabled:opacity-80",children:_?"Saving...":"Save Changes"})]})]})}),e.jsx("p",{className:"text-red-700 mt-7",children:F&&"something went wrong"}),e.jsx("p",{className:"text-green-700 mt-7",children:E&&"Updated Successfully"}),e.jsx("button",{onClick:T,className:"text-green-700 w-full",children:"Show Created Provider"}),e.jsx("p",{className:"text-red-700 mt-7",children:D?"Error showing Provider":""}),p&&p.length>0&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-center mt-7 text-2xl font-semibold",children:"Your Providers"}),p.map(s=>e.jsxs("div",{className:" rounded-lg p-3 flex gap-4 justify-between items-center",children:[e.jsx(b,{to:`/provider/${s._id}`,children:e.jsx("img",{src:s.imageUrls[0],alt:"provider cover",className:"h-16 w-16 object-contain"})}),e.jsx(b,{onClick:()=>n(z(s._id)),className:"flex-1 font-semibold hover:underline truncate",to:`/provider/${s._id}`,children:e.jsx("p",{children:s.fullName})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("button",{onClick:()=>$(s._id),className:"text-red-700 uppercase",children:"Delete"}),e.jsx(b,{to:"/dashboard?tab=providers",children:e.jsx("button",{className:"text-green-700 uppercase",children:"EDIT"})})]})]},s._id))]})]})]})}export{ie as default};
