import{r as i,j as e}from"./react-DiIsFRGf.js";import{i as re,g as te,r as le,u as ie,a as oe}from"./@firebase-ZU7arh2v.js";import"./firebase-B_c1zOww.js";import{u as F,a as ne}from"./react-redux-Cmcgb_ry.js";import{_ as u}from"./react-hot-toast-BDpxPdYe.js";import{u as de}from"./react-router-Ck6p_Z-K.js";import{S as N}from"./react-select-xtze-_c4.js";import{S as ce,C as ue,a as E}from"./country-state-city-B5NRDuuX.js";import{c as pe}from"./@reduxjs-lV2PETub.js";import{_ as me}from"./react-spinners-D_wes01j.js";import{F as fe}from"./flowbite-react-moIAvRiJ.js";import{I as he}from"./react-phone-number-input-ASBvvjCp.js";import{I as _}from"./react-icons-4Z_jIp8v.js";const xe={apiKey:"AIzaSyASHMcld3kOmv-kz6zp0RKKNiYXnXH-vo8",authDomain:"step-1d272.firebaseapp.com",projectId:"step-1d272",storageBucket:"step-1d272.appspot.com",messagingSenderId:"833106800742",appId:"1:833106800742:web:946fa4a9b0a173590f3da7"},ge=re(xe),be={currentProvider:null,loading:!1,error:null},R=pe({name:"provider",initialState:be,reducers:{selectProvider:(l,p)=>{l.id=p.payload},selectUser:(l,p)=>{l.user=p.payload},providerData:(l,p)=>{p.payload?l.currentProvider=p.payload:l.currentProvider=null,l.loading=!1,l.error=!1},providerOut:l=>{l.currentProvider=null,l.loading=!1,l.error=!1}}}),{selectProvider:ve,providerData:ke,providerOut:Fe,selectUser:_e}=R.actions,Re=R.reducer;function ye(){const{currentUser:l}=F(s=>s.user);F(s=>s.provider);const[p,$]=i.useState([]),[I,D]=i.useState(""),[C,f]=i.useState(!1),[S,g]=i.useState(!1),[b,j]=i.useState(!1),[h,O]=i.useState({}),L=de(),T=i.useRef(null),M=ne(),[z,B]=i.useState(""),[a,n]=i.useState({imageUrls:[],name:"",email:"",qualification:"",license:"",fullName:"",experience:"",phone:z,address:{addressLine1:"",country:"",state:"",city:"",street:"",pincode:""},therapytype:"",availability:{morningStart:"",morningEnd:"",eveningStart:"",eveningEnd:""},regularPrice:"",description:"",profilePicture:""}),[d,m]=i.useState({phone:!1,email:!1,description:!1,profilePicture:!1}),V=s=>{n({...a,imageUrls:a.imageUrls.filter((r,t)=>t!==s)})},W=()=>{if(p.length>0&&p.length+a.imageUrls.length<7){f(!0),D(!1);const s=[];for(let r=0;r<p.length;r++)s.push(q(p[r]));Promise.all(s).then(r=>(n({...a,imageUrls:a.imageUrls.concat(r)}),D(!1),f(!1),u.success("Image uploaded successfully"))).catch(()=>{u.error("Image upload failed(2 mb max per image)"),f(!1)})}else u.error("you can only upload 6 images per provider"),f(!1)},q=async s=>new Promise((r,t)=>{const c=te(ge),v=new Date().getTime()+s.name,x=le(c,v),k=ie(x,s);k.on("state_changed",y=>{const ae=y.bytesTransferred/y.totalBytes*100;console.log(`Upload is ${ae} % done`)},y=>{t(y)},()=>{oe(k.snapshot.ref).then(y=>{r(y)})})}),o=s=>{const{id:r,value:t,type:c}=s.target;["addressLine1","street","pincode"].includes(r)?n(x=>({...x,address:{...x.address,[r]:t}})):n(c==="time"?x=>({...x,availability:{...x.availability,[r]:t}}):{...a,[r]:t})},Y=async s=>{s.preventDefault();try{let r={...d};if(!a.profilePicture||a.profilePicture.length<1)return r.profilePicture=!0,m(r),u.error("You must upload a profile picture");if(r.profilePicture=!1,m(r),/\S+@\S+\.\S+/.test(a.email))r.email=!1,m(r);else return r.email=!0,m(r),u.error("Invalid email address");if(!a.phone||a.phone.length!==13)return r.phone=!0,m(r),u.error("Phone number must be 10 digits");if(r.phone=!1,m(r),!a.description||a.description.length<40)return r.description=!0,m(r),u.error("Description must be at least 40 characters");if(r.description=!1,m(r),!a.imageUrls||a.imageUrls.length<1)return r.imageUrls=!0,m(r),u.error("You must upload at least one image");r.imageUrls=!1,m(r),j(!0),g(!1);const c=await(await fetch("/server/provider/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,userRef:l._id})})).json();j(!1),c.success&&g(c.message),L(`/provider/${c._id}`),M(ve(c._id))}catch(r){g(r.message),j(!1)}},H=s=>{s.preventDefault(),T.current.click()},K=s=>{const r=s.target.files[0];r&&(f(!0),q(r).then(t=>{n({...a,profilePicture:t}),f(!1),u.success("Profile image uploaded successfully")}).catch(()=>{u.error("Profile image upload failed"),f(!1)}))},P=[{value:"Diagnostic Evaluation",label:"Diagnostic Evaluation"},{value:"Speech Therapy",label:"Speech Therapy"},{value:"ABA Therapy",label:"ABA Therapy"},{value:"Occupational Therapy",label:"Occupational Therapy"},{value:"School-Based Service",label:"School-Based Service"},{value:"Dance Movement",label:"Dance Movement"},{value:"Art as Therapy",label:"Art as Therapy"},{value:"Counselling",label:"Counselling"}],U=[{value:"Virtual",label:"Virtual"},{value:"In-Clinic",label:"In-Clinic"},{value:"In-Home",label:"In-Home"}],[A,J]=i.useState(),[Q,X]=i.useState([]);let G=E.getAllCountries();const[w,Z]=i.useState(G[0]);let ee=ce.getStatesOfCountry(w.isoCode);i.useEffect(()=>{if(w&&A){const s=ue.getCitiesOfState(w.isoCode,A);X(s)}},[w,A]),i.useEffect(()=>{(async()=>{if(j(!0),!l)return;const t=await(await fetch(`/server/provider/fetchprovider/${l._id}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();O(t),j(!1),t.status===!0&&n({...a,...t.fetchprovider,name:t.fetchprovider.name.map(c=>P.find(v=>v.value===c).value),therapytype:t.fetchprovider.therapytype.map(c=>U.find(v=>v.value===c).value),address:{...a.address,addressLine1:t.fetchprovider.address.addressLine1,street:t.fetchprovider.address.street,country:t.fetchprovider.address.country,state:t.fetchprovider.address.state,city:t.fetchprovider.address.city,pincode:t.fetchprovider.address.pincode}})})()},[l]);const se=async s=>{s.preventDefault();try{if(a.imageUrls.length<1)return u.error("You must upload at least one image");g(!1);const t=await(await fetch(`/server/provider/update/${h.fetchprovider._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,userRef:l._id})})).json();t.success&&g(t.message),u.success("Provider updated successfully")}catch(r){g(r.message)}};return e.jsx("div",{className:"md:p-10 p-5 w-full mx-auto flex-col items-center bg-sky-100",children:b?e.jsx(e.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh"},children:e.jsx(me,{color:"#AFDBD8",loading:b,size:20})})}):e.jsxs(e.Fragment,{children:[l._id===(h&&h.fetchprovider&&h.fetchprovider.userRef)?e.jsx(e.Fragment,{children:e.jsxs("h1",{className:"flex flex-col p-2 font-bold text-2xl text-gray",children:[" ","Your Provider Details :"]})}):e.jsx(e.Fragment,{children:e.jsx("h1",{className:"text-base text-gray-700 font-semibold text-left my-7 mt-5",children:"Fill the form to create a provider"})}),e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:T,hidden:!0,accept:"image/*",required:!0,onChange:K}),e.jsx("div",{className:"relative w-24 h-24 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:H,children:[e.jsx("img",{src:a.profilePicture||"https://i.ibb.co/tKQH4zp/defaultprofile.jpg",alt:"profile",className:`w-24 h-24 rounded-full object-cover border-4 border-[lightgray] ${d.profilePicture&&"border-red-500"}`}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-8 h-8"}),e.jsx("p",{className:"text-white text-xs",children:"Choose Profile"})]})]})}),e.jsx("div",{className:"w-full flex justify-center mt-2",children:d.profilePicture&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please upload a profile picture"})}),e.jsx("div",{className:"bg-white",children:e.jsxs("form",{onSubmit:Y,className:"flex flex-col sm:flex-row gap-10 mt-6 md:p-20 p-6 rounded-lg mx-auto",children:[e.jsxs("div",{className:"flex flex-col gap-3 flex-1",children:[e.jsx("label",{className:"font-semibold text-main",children:"Select service*"}),e.jsx(N,{id:"name",options:P,isMulti:!0,required:!0,placeholder:"What service do you provide?",touchUi:!1,className:"border-2 p-1 rounded-lg border-slate-300 input hover:border-purple-400",defaultValue:Array.isArray(a.name)?a.name.map(s=>P.find(r=>r.value===s)):[],onChange:s=>{n(r=>({...r,name:s.map(t=>t.value)}))},styles:{control:s=>({...s,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},a.name),e.jsx("label",{className:"font-semibold text-main",children:"Full Name*"}),e.jsx("input",{type:"text",placeholder:"Full Name",className:"border-2 p-2 rounded-lg border-slate-300 input focus:outline-none focus:ring-0",id:"fullName",required:!0,onChange:o,value:a.fullName}),e.jsx("label",{className:"font-semibold text-main",children:e.jsxs("p",{className:"flex flex-row items-center",children:[d.email&&e.jsx(_,{className:"text-red-700 text-sm"}),"Email*"," "]})}),e.jsx("input",{placeholder:"Email",className:`border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300 ${d.email?"error":""}`,id:"email",required:!0,onChange:o,value:a.email}),d.email&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please enter a valid email address."}),e.jsx("label",{className:"font-semibold text-main",children:"Qualification*"}),e.jsx("input",{type:"text",placeholder:"(e.g.,Psychologist, Counselor)",className:"border-2 p-2 rounded-lg input focus:ring-0 border-slate-300",id:"qualification",required:!0,onChange:o,value:a.qualification}),e.jsx("label",{className:"font-semibold text-main",children:"Address*"}),e.jsx("input",{placeholder:"Address",className:"border-2 p-2 rounded-lg border-slate-300 input focus:outline-none focus:ring-0 ",id:"addressLine1",required:!0,onChange:o,value:a.address.addressLine1}),e.jsx("label",{className:"font-semibold text-main",children:"Street"}),e.jsx("input",{placeholder:"Street",className:"w-full border-2 p-2 rounded-lg border-slate-300 input focus:outline-none focus:ring-0 ",id:"street",onChange:o,value:a.address.street}),e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"Country*"}),e.jsx(N,{id:"country",placeholder:"Country",defaultValue:a.address.country?{value:a.address.country,label:a.address.country}:void 0,options:E.getAllCountries().map(s=>({value:s.name,label:s.name})),className:"w-full rounded-lg border-2 border-slate-300 hover:border-purple-400",onChange:s=>{const r=E.getAllCountries().find(t=>t.name===s.value);Z(r),n({...a,address:{...a.address,country:s.label}})},styles:{control:s=>({...s,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},a.address.country)]}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"State*"}),e.jsx(N,{id:"state",defaultValue:a.address.state?{value:a.address.state,label:a.address.state}:void 0,options:ee.map(s=>({value:s.isoCode,label:s.name})),placeholder:"State",className:"w-full rounded-lg border-2 border-slate-300 hover:border-purple-400",onChange:s=>{J(s.value),n({...a,address:{...a.address,state:s.label}})},styles:{control:s=>({...s,backgroundColor:"transparent",minWidth:"100px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},`state-${a.address.state}`)]})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"City*"}),e.jsx(N,{id:"city",defaultValue:a.address.city?{value:a.address.city,label:a.address.city}:void 0,options:Q.map(s=>({value:s.name,label:s.name})),className:"w-full border-2 rounded-lg border-slate-300 hover:border-purple-400",placeholder:"Select City",onChange:s=>{n({...a,address:{...a.address,city:s.label}})},styles:{control:s=>({...s,backgroundColor:"transparent",minWidth:"160px",border:"none",outline:"none",boxShadow:"none",transition:"all 0.3s ease"})}},a.address.city)]}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:"Pincode*"}),e.jsx("input",{placeholder:"Pincode",className:"w-full border-2 p-1.5 border-slate-300 rounded-lg input focus:outline-none focus:ring-0",id:"pincode",required:!0,onChange:o,value:a.address.pincode})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold text-main md:text-base text-sm",children:"fee per Appoinment*"}),e.jsx("input",{type:"number",id:"regularPrice",min:"50",max:"100000",required:!0,className:"border-2 p-3 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",onChange:o,value:a.regularPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{className:"text-main md:text-sm text-xs font-semibold",children:"Regular Fees"}),e.jsx("span",{className:"text-main font-semibold text-xs",children:"( ₹ Appointment )"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold text-main md:text-base text-sm",children:"Years of Experience*  "}),e.jsx("input",{type:"number",id:"experience",min:"0",max:"100000",required:!0,className:"border-2 p-3 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",onChange:o,value:a.experience}),e.jsxs("div",{className:"flex flex-col items-center ",children:[e.jsx("p",{className:"text-main md:text-sm text-xs font-semibold",children:"Service"}),e.jsx("span",{className:"text-main font-semibold text-xs",children:"( no. of Experience )"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col flex-1 gap-3",children:[e.jsxs("p",{className:"font-semibold text-main",children:["Explain About your therapy section*",e.jsx("span",{className:"text-sm",children:"  (40 minimum words)"})]}),e.jsx("textarea",{type:"text",placeholder:"Now is the chance to show your future clients that your approach to therapy will make a real difference!",rows:5,className:`border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300 ${d.description?"error":""}`,id:"description",required:!0,onChange:o,value:a.description}),d.description&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please write a 40-word description in the field."}),e.jsx("label",{className:"font-semibold text-main",children:"Select your therapy type*"}),e.jsx(N,{id:"therapytype",options:U,isMulti:!0,required:!0,placeholder:"Type of Therapy",touchUi:!1,defaultValue:Array.isArray(a.therapytype)?a.therapytype.map(s=>U.find(r=>r.value===s)):[],className:"border-2 p-1 rounded-lg border-slate-300 bg-white input hover:border-purple-400",onChange:s=>{n(r=>({...r,therapytype:s.map(t=>t.value)}))},styles:{control:s=>({...s,backgroundColor:"transparent",minWidth:"160px",border:"none",boxShadow:"none",transition:"all 0.3s ease"})}},a.therapytype),e.jsx("label",{className:"font-semibold text-main",children:"Licensing*"}),e.jsx("input",{type:"text",placeholder:"(License number, issuing authority)",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",id:"license",required:!0,onChange:o,value:a.license}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"font-semibold text-main",children:e.jsxs("p",{className:"flex flex-row items-center",children:[d.phone&&e.jsx(_,{className:"text-red-700 text-sm"}),"Phone*"]})}),e.jsx(he,{placeholder:"Phone number",className:`border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300 ${d.phone?"error":""}`,id:"phone",required:!0,onChange:s=>{B(s),n({...a,phone:s})},value:a.phone}),d.phone&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Please enter a 10-digit number."}),e.jsx("p",{className:"font-semibold text-main",children:"Availability:"}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("p",{className:"font-semibold text-main",children:"Morning:"}),e.jsx("input",{type:"time",id:"morningStart",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:a.availability.morningStart,onChange:o}),e.jsx("input",{type:"time",id:"morningEnd",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:a.availability.morningEnd,onChange:o})]}),e.jsxs("div",{className:"flex flex-row gap-4 pl-1",children:[e.jsx("p",{className:"font-semibold text-main",children:"Evening:"}),e.jsx("input",{type:"time",id:"eveningStart",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:a.availability.eveningStart,onChange:o}),e.jsx("input",{type:"time",id:"eveningEnd",className:"border-2 p-2 rounded-lg input focus:outline-none focus:ring-0 border-slate-300",required:!0,value:a.availability.eveningEnd,onChange:o})]})]}),e.jsxs("p",{className:"font-semibold text-main",children:["Images:",e.jsx("span",{className:"font-normal text-gray-600 ml-2",children:"The first image will be the cover. pick image for showcase (max 6)"})]}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx(fe,{onChange:s=>$(s.target.files),className:"p-3 rounded w-full",type:"file",id:"images",accept:"image/*",multiple:!0}),e.jsx("button",{type:"button",disabled:C,onClick:W,className:`p-2 max-h-10 text-green-700 border border-green-700 rounded uppercase hover:shadow-lg disabled:opacity-85 ${d.imageUrls&&"error"}`,children:C?"uploading...":"upload"})]}),e.jsx("div",{className:"",children:d.imageUrls&&e.jsxs("p",{className:"text-sm text-red-500 font-semibold",children:[" ","Please upload at least one image."]})}),e.jsx("p",{className:"text-red-700 text-xs",children:I&&I}),a.imageUrls.length>0&&a.imageUrls.map((s,r)=>e.jsxs("div",{className:"flex justify-between p-3 border items-center",children:[e.jsx("img",{src:s,alt:"image",className:"w-20 h-20 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>V(r),className:"p-3 text-red-700 rounded-lg uppercase hover:opacity-75",children:"Delete"})]},r)),l._id===(h&&h.fetchprovider&&h.fetchprovider.userRef)?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"submit",onClick:se,disabled:b||C,className:"p-3 bg-blue-600 text-white rounded=lg rounded-lg Captialize hover:opacity-95 disabled:opacity-80 transition-all duration-300 ease-in-out",children:b?"Saving...":"Save Changes"}),S&&e.jsx("p",{className:"text-red-700 text-xs",children:S})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"submit",disabled:b||C,className:"p-3 btn-color rounded-lg font-semibold  rounded=lg hover:opacity-85 disabled:opacity-80 transition-all duration-300 ease-in-out",children:b?"Creating Provider":"Create Provider"}),S&&e.jsx("p",{className:"text-red-700 text-xs",children:S})]})]})]})})]})})}const $e=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));export{ye as C,ke as a,ge as b,_e as c,Re as d,$e as e,Fe as p,ve as s};
