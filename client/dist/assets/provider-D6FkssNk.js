import{r as l,j as e}from"./react-DiIsFRGf.js";import{u as v,a as k}from"./react-redux-Cmcgb_ry.js";import{L as h}from"./react-router-dom-Cj7EZRaW.js";import{W as R,i as L,d as $,U as g,k as j,l as p,X as H}from"./react-icons-4Z_jIp8v.js";import{P as r}from"./prop-types-DepTH4Nk.js";import{_ as C}from"./react-hot-toast-BDpxPdYe.js";import{L as V}from"./modal-Dnp8jk4l.js";import{M as y,T as P}from"./flowbite-react-moIAvRiJ.js";import{t as D,f as W,a as G}from"./Provider.jsx-mGc_QB6z.js";import{s as N}from"./CreateProvider.jsx-CujhAS3a.js";import{C as X}from"./react-content-loader-DBgsaXRA.js";import{a as J}from"./react-router-Ck6p_Z-K.js";import{S as K}from"./SearchBar.jsx-D6SmUb86.js";function _({provider:s}){const[c,d]=l.useState(!1),[t,I]=l.useState(0),{currentUser:m}=v(i=>i.user),[n,S]=l.useState("urlsearchTerm"),[z,w]=l.useState(!0),[q,b]=l.useState(!1),T=J(),F=new URLSearchParams(T.search).get("searchTerm"),o=k(),B=encodeURIComponent(s.fullName).replace(/%20/g,"-"),A=encodeURIComponent(s.address.city),U=encodeURIComponent(s.address.state).replace(/%20/g,"-"),M=encodeURIComponent(s.address.pincode),f=`/provider/${B}`,u=`?city=${A}?state=${U}&service=${n}&pincode=${M}`;l.useEffect(()=>{S(F),window.scrollTo({top:0})},[F]);function E(){console.log("close modal"),b(!1)}const O=async()=>{if(!m){b(!0);return}try{o(D({userId:m._id,providerId:s._id})),C.success(`Provider ${c?"removed from":"added to"} favorites`),d(i=>!i)}catch(i){console.error(i),C.error("Failed to update favorite status")}};return l.useEffect(()=>{(async()=>{if(m){try{const a=await o(W({userId:m._id,providerId:s._id}));a.payload!==void 0&&d(a.payload)}catch(a){console.log(a)}w(!1)}})()},[m,o,s._id]),l.useEffect(()=>{(async()=>{try{const x=await(await fetch(`/server/rating/getreview/${s._id}`)).json();I(x)}catch(a){console.error("Error:",a)}w(!1)})()},[s._id]),e.jsx(e.Fragment,{children:z?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center text-xl text-slate-700 w-full",children:e.jsx("div",{className:"md:hidden block mb-2",children:e.jsxs(X,{viewBox:"0 0 320 220",speed:2,height:240,width:370,backgroundColor:"#f5f5f5",foregroundColor:"#D1BEE0",children:[e.jsx("circle",{cx:"40",cy:"60",r:"36"}),e.jsx("rect",{x:"90",y:"34",rx:"4",ry:"4",width:"100",height:"9"}),e.jsx("rect",{x:"90",y:"56",rx:"4",ry:"4",width:"140",height:"13"}),e.jsx("rect",{x:"90",y:"80",rx:"4",ry:"4",width:"290",height:"9"}),e.jsx("rect",{x:"20",y:"110",rx:"4",ry:"4",width:"150",height:"9"}),e.jsx("rect",{x:"20",y:"130",rx:"4",ry:"4",width:"190",height:"9"}),e.jsx("rect",{x:"20",y:"150",rx:"4",ry:"4",width:"100",height:"9"}),"(button)",e.jsx("rect",{x:"20",y:"180",rx:"4",ry:"4",width:"290",height:"34"})]})},s._id)})}):e.jsxs("div",{className:"group mt-4 w-full relative border pr-card shadow-md hover:shadow-lg overflow-hidden rounded-lg transition-all hover:-translate-y-2 duration-500 ease-in-out",children:[s.totalBookings===null?e.jsx("div",{className:"md:flex flex-col items-center bg-white text-sm p-1.5 hidden",children:e.jsx("p",{className:"text-white",children:"No Recent Bookings"})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col items-center bg-green-300 text-sm p-1.5",children:s.totalBookings!==null&&e.jsx(e.Fragment,{children:s.totalBookings.length===1?e.jsx("p",{children:"Got Booking in Recently"}):e.jsxs("p",{children:[s.totalBookings," Bookings in Recent Times"]})})})}),e.jsx("button",{onClick:O,className:"p-2 absolute top-0 right-0 md:top-9 md:right-2 z-10",children:c?e.jsx(R,{className:"text-pink-600 size-6 lg:size-7 hover:bg-pink-100 rounded-md transition duration-300"}):e.jsx(R,{className:"text-zinc-400 size-6 lg:size-7 hover:bg-zinc-200 rounded-md transition duration-300"})}),e.jsxs("div",{className:"hidden md:flex flex-col p-2 absolute top-9 left-2 z-10 justify-center items-center ",children:[e.jsx(L,{className:"h-4 w-4 lg:size-5 star"}),e.jsx("p",{className:"text-sm lg:text-base text-gray-600 font-bold truncate w-full",children:t&&t.totalrating!==void 0&&(t.totalrating==="0.00"||t.totalrating==="0"||isNaN(parseFloat(t.totalrating)))?"No reviews":`${parseFloat(t==null?void 0:t.totalrating).toFixed(2)} (${(t==null?void 0:t.totalratings)||0})`})]}),e.jsxs(y,{show:q,size:"md",onClose:E,popup:!0,children:[e.jsx(y.Header,{}),e.jsx(y.Body,{children:e.jsx(V,{})})]}),e.jsxs("div",{className:"flex flex-col gap-2 p-3 w-full items-start md:items-center",children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("div",{className:"hidden w-full md:flex flex-col items-center",children:[e.jsx("div",{className:"relative w-40 h-40 items-center rounded-full overflow-hidden md:border-4 border-gray-100 lg:mt-4 group-hover:-translate-y-2 duration-700 ease-in-out",children:e.jsx("img",{src:s.profilePicture,alt:"provider profile",className:"absolute w-full h-full object-cover",loading:"lazy"})}),e.jsx(h,{to:{pathname:f,search:u,state:{searchTerm:n}},onClick:()=>o(N(s._id)),children:e.jsxs("div",{className:"flex flex-row items-center gap-2 truncate text-2xl font-semibold provideritem-name hover:underline mt-2",children:[s.fullName,s.verified===!0&&e.jsx(e.Fragment,{children:e.jsx(P,{content:"Verifed Profile",animation:"duration-500",placement:"bottom",children:e.jsx($,{})})})]})}),e.jsx("div",{className:"flex flex-row items-center text-xs md:text-base 2xl:text-lg provideritem-service font-semibold truncate",children:Array.isArray(s.name)?(()=>{const i=s.name.findIndex(x=>n&&x.toLowerCase()===n.toLowerCase());let a=[...s.name];return i!==-1&&(a=[s.name[i],...s.name.slice(0,i),...s.name.slice(i+1)]),e.jsxs(e.Fragment,{children:[a.slice(0,1),a.length>1?e.jsxs(e.Fragment,{children:[","," ",e.jsxs(h,{className:"hover:underline",to:`/search?searchTerm=${encodeURIComponent(a[1])}&address=${s.address.city}`,children:[a[1].slice(0,14),a[1].slice(14)?"...":""]})]}):null,a.length>2?` +${a.length-2}more`:""]})})():s.name}),e.jsx("div",{className:"md:flex flex-col items-center hidden",children:e.jsxs("div",{className:"items-start",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(g,{className:"h-4 w-4 lg:size-5 icon-color"}),e.jsxs("p",{className:"text-sm lg:text-base provideritem-service truncate w-full",children:[s.address.addressLine1," ",s.address.city,","," ",s.address.state]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 lg:size-5 icon-color"}),e.jsxs("p",{className:"text-sm lg:text-base provideritem-service truncate w-full",children:[s.experience," years experience overall"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"h-4 w-4 lg:size-5 icon-color"}),e.jsx("p",{className:"text-sm lg:text-base provideritem-service truncate w-full",children:Array.isArray(s.therapytype)?`${s.therapytype.slice(0,4).join(", ")}`:`${s.therapytype}`})]})]})})]}),e.jsxs("div",{className:"w-full flex md:hidden",children:[e.jsx("div",{className:"relative h-16 w-16 md:w-28 md:h-28 rounded-full overflow-hidden border-gray-100",children:e.jsx("img",{src:s.profilePicture,alt:"provider profile",className:"absolute w-full h-full object-cover",loading:"lazy"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-4 w-4 star"}),e.jsx("p",{className:"text-sm text-gray-600 font-bold truncate w-full",children:t&&t.totalrating!==void 0&&(t.totalrating==="0.00"||t.totalrating==="0"||isNaN(parseFloat(t.totalrating)))?"No reviews":`${parseFloat(t==null?void 0:t.totalrating).toFixed(2)} (${(t==null?void 0:t.totalratings)||0})`})]}),e.jsx(h,{to:{pathname:f,search:u,state:{searchTerm:n}},onClick:()=>o(N(s._id)),children:e.jsxs("div",{className:"flex flex-row items-center gap-2 truncate text-xl font-semibold provideritem-name hover:underline",children:[s.fullName,s.verified===!0&&e.jsx(e.Fragment,{children:e.jsx(P,{content:"Verifed Profile",animation:"duration-500",placement:"right",children:e.jsx($,{})})})]})}),e.jsx("div",{className:"text-xs md:text-sm provideritem-service font-semibold truncate w-full",children:Array.isArray(s.name)?(()=>{const i=s.name.findIndex(x=>n&&x.toLowerCase()===n.toLowerCase());let a=[...s.name];return i!==-1&&(a=[s.name[i],...s.name.slice(0,i),...s.name.slice(i+1)]),e.jsxs(e.Fragment,{children:[a.slice(0,1),a.length>1?e.jsxs(e.Fragment,{children:[","," ",e.jsx(h,{className:"hover:underline",to:`/search?searchTerm=${encodeURIComponent(a[1])}&address=${s.address.city}`,children:a[1]})]}):null,a.length>2?` +${a.length-2} more`:""]})})():s.name}),e.jsxs("div",{className:"md:inline hidden",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(g,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.address.addressLine1," ",s.address.city,","," ",s.address.state]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.experience," years experience overall"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"h-4 w-4 icon-color"}),e.jsx("p",{className:"text-sm provideritem-service truncate w-full",children:Array.isArray(s.therapytype)?`${s.therapytype.slice(0,4).join(", ")}`:`${s.therapytype}`})]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:hidden",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(g,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.address.addressLine1,",",s.address.city]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 icon-color"}),e.jsxs("p",{className:"text-sm provideritem-service truncate w-full",children:[s.experience," years experience overall"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"h-4 w-4 icon-color"}),e.jsx("p",{className:"text-sm provideritem-service truncate w-full",children:Array.isArray(s.therapytype)?`${s.therapytype.slice(0,4).join(", ")}`:`${s.therapytype}`})]})]})]}),e.jsx("hr",{className:"w-full border-gray-200"}),e.jsxs("div",{className:"flex flex-row items-center justify-between w-full",children:[e.jsxs("div",{className:"md:flex hidden provideritem-name items-center pl-2 md:text-xl 2xl:text-2xl",children:[e.jsx(H,{className:"pt-0.5"}),Math.floor(s.regularPrice)]}),e.jsx("div",{className:"p-1.5 flex flex-col w-full md:items-end",children:e.jsx(h,{to:{pathname:f,search:u,state:{searchTerm:n}},children:e.jsx("button",{onClick:()=>o(N(s._id)),className:" card-btn w-full md:w-auto p-2 lg:p-2 rounded-md font-semibold transition duration-300",children:"View Profile"})})})]})]})]})})}_.propTypes={provider:r.shape({_id:r.string.isRequired,imageUrls:r.arrayOf(r.string).isRequired,name:r.arrayOf(r.string),therapytype:r.arrayOf(r.string).isRequired,fullName:r.string.isRequired,experience:r.string.isRequired,address:r.shape({addressLine1:r.string.isRequired,city:r.string.isRequired,state:r.string.isRequired,pincode:r.number.isRequired}).isRequired,totalrating:r.number,totalBookings:r.number,numberofratings:r.number,description:r.string.isRequired,profilePicture:r.string.isRequired,regularPrice:r.number.isRequired,verified:r.bool}).isRequired};function Q(){const{currentUser:s}=v(t=>t.user),{favorites:c}=v(t=>t.favorite),d=k();return console.log("favorite",c),l.useEffect(()=>{(async()=>{s&&d(G(s._id))})()},[s,d]),e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("div",{className:"h-52vh md:h-72vh bg-listbg bg-cover bg-center flex flex-col justify-center items-center text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"md:text-2xl text-xl font-semibold text-zinc-600",children:"Lists"}),e.jsx("h1",{className:"md:text-5xl text-3xl font-bold md:mt-4 text-gray-700",children:"My Saved Lists"})]})}),e.jsx("div",{children:c.filter(Boolean).length>0?e.jsx("div",{className:"p-4 grid sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.filter(Boolean).map(t=>e.jsx(_,{provider:{...t,totalBookings:null},isFavorite:!0},t._id))}):e.jsxs("div",{className:"flex flex-col justify-center items-center mt-10",children:[e.jsx("div",{className:"text-2xl font-semibold mb-6 text-zinc-600 text-center",children:"No Favorite Providers Not yet saved"}),e.jsx("div",{className:"md:flex items-center text-2xl font-semibold mt-6 mb-6",children:e.jsx(K,{})})]})})]})}const xe=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{xe as F,_ as P};
