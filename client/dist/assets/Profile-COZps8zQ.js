import{G as ae,r as a,a as re,b as le,j as e,M as y,a5 as R,h as _,k as oe,a6 as ne,L as v,X as ie,a0 as ce,n as de,q as $,t as ue,_ as x}from"./index-D_NL2s92.js";import{g as me,r as xe,u as ge,a as he}from"./index.esm2017-D1tw8w_s.js";import{b as T}from"./index-V-OXqPZT.js";import{a as fe}from"./index-BzLexLbk.js";function pe(d){return ae({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(d)}function ye(){const d=a.useRef(null),[g,L]=a.useState(),[u,M]=a.useState(0),[B,O]=a.useState(!1),[n,P]=a.useState({profilePicture:""}),h=a.useRef(null),[z,V]=a.useState(!1),[i,A]=a.useState(!1),[S,H]=a.useState({password:"",newPassword:""}),[q,f]=a.useState(!1),[p,C]=a.useState([]),{currentUser:l,loading:G}=re(s=>s.user),[J,j]=a.useState(!1),c=le();a.useEffect(()=>{g&&K(g)},[g]);const K=async s=>{const t=me(ce),r=new Date().getTime()+s.name,N=xe(t,r),m=ge(N,s);m.on("state_changed",o=>{const te=o.bytesTransferred/o.totalBytes*100;M(Math.round(te))},o=>{O(!0),console.log(o)},()=>{he(m.snapshot.ref).then(o=>{P({...n,profilePicture:o}),j(!0)})})},Q=s=>{s.preventDefault(),d.current.click()},W=async s=>{s.preventDefault();try{h.current.continuousStart(50),c(de());const r=await(await fetch(`/server/user/update/${l._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();if(r.success===!1){c($(r));return}c(ue(r)),V(!0),j(!1),x.success("Profile Updated Successfully")}catch(t){c($(t))}finally{h.current.complete()}},k=s=>{s.target.id==="username"&&(s.target.value=s.target.value.replace(/[^a-zA-Z\s]/g,"")),P({...n,[s.target.id]:s.target.value}),j(!0)},X=async()=>{try{f(!1);const t=await(await fetch(`/server/user/providers/${l._id}`)).json();if(t.success===!1){f(!0);return}C(t)}catch{f(!0)}},Y=async s=>{try{const r=await(await fetch(`/server/provider/delete/${s}`,{method:"DELETE"})).json();if(r.success===!1)return console.log(r),x.success("Provider Deleted Successfully");C(N=>N.filter(m=>m._id!==s))}catch(t){console.log(t.message)}},[E,b]=a.useState(!1),[D,U]=a.useState(""),Z=async()=>{try{const t=await(await fetch(`/server/user/resetpassword/${l._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).json();if(t.success===!1){b(!0),U(t.message),x.error(t.message);return}x.success(t.message),U(t.message),b(!1)}catch(s){b(!0),console.log(s)}},F=s=>{H({...S,[s.target.id]:s.target.value})},I=()=>{A(!i)},[ee,w]=a.useState(!1),se=()=>{w(!1)};return e.jsxs("div",{className:"bg-slate-100 p-3 mx-auto",children:[e.jsxs(y,{onClose:se,show:ee,popup:!0,size:"md",children:[e.jsx(y.Header,{children:"Reset Password"}),e.jsxs(y.Body,{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"password",children:"Enter old Password :"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{autoComplete:"off",type:i?"text":"password",id:"password",onChange:F,className:`w-full text-gray-800 bg-state-100 rounded-lg ring-0 ring-inset py-2 border-1 focus:ring-2 bg-slate-100 mt-2 hover:border-purple-400 ${E?"border-red-500":"border-purple-300"}`}),e.jsx("div",{className:"absolute right-0 top-1/3 mt-0.5 mr-4",children:e.jsx("button",{type:"button",onClick:I,children:i?e.jsx(R,{className:"text-slate-700"}):e.jsx(T,{className:"text-slate-600"})})})]}),e.jsx("label",{htmlFor:"newPassword",children:"Enter New Password :"}),e.jsx("input",{autoComplete:"off",type:i?"text":"password",id:"newPassword",onChange:F,className:"text-gray-800 bg-state-100 rounded-lg ring-0 ring-inset py-2 border-1 focus:ring-2 bg-slate-100 mt-2 mb-4 border-purple-300 hover:border-purple-400"})]}),D&&e.jsx("p",{className:"text-red-500 text-sm",children:D}),e.jsxs("div",{className:"flex flex-row gap-2 mt-4",children:[e.jsx(_.Button,{variant:"outlined",className:"w-full",onClick:()=>w(!1),children:"Cancel"}),e.jsx(_.Button,{onClick:Z,className:"w-full btn-color",children:"CONFIRM"})]})]})]}),e.jsx(oe,{ref:h,color:"#ff9900",height:3}),e.jsxs("h1",{className:"flex flex-col p-2 mb-4 font-bold text-2xl text-gray",children:["Account Settings :"," "]}),e.jsxs("div",{className:"p-10 bg-white rounded-lg border",children:[e.jsx("div",{children:e.jsxs("form",{className:"flex flex-col items-start gap-7 md:w-[900px]",onSubmit:W,children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:d,hidden:!0,accept:"image/*",onChange:s=>L(s.target.files[0])}),e.jsx("div",{className:"relative w-34 h-34 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:Q,children:[e.jsx("img",{src:l.profilePicture||n.profilePicture||"https://i.ibb.co/tKQH4zp/defaultprofile.jpg",alt:"profile",className:"w-32 h-32 rounded-full object-cover border-4 border-[lightgray]"}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-10 h-10"}),e.jsx("p",{className:"text-white text-xs",children:"Change Picture"})]})]})}),e.jsx("p",{className:"text-sm self-center",children:B?e.jsx("span",{className:"text-red-500",children:"Please upload a valid image"}):u>0&&u<100?e.jsx("span",{children:`Uploading: ${u}%`}):u===100?e.jsx("span",{className:"text-green-700",children:"Image Uploaded Successfully"}):""})]}),e.jsxs("div",{className:"flex flex-col w-72 md:w-1/2 gap-2 relative",children:[e.jsx("label",{htmlFor:"username",className:"text-xl text-slate-600",children:"Username"}),e.jsxs("div",{className:"flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(ne,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{autoComplete:"off",defaultValue:l.username,type:"text",id:"username",maxLength:20,required:!0,placeholder:"username",className:"text-xl pl-3 w-52 text-gray-800 bg-state-100 p-3 rounded-lg ring-0 ring-inset py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:k})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Email Address"}),e.jsxs("div",{className:"flex items-center mt-2 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(pe,{className:"ml-3 text-xls w-5 h-5 text-gray-400"}),e.jsx("input",{autoComplete:"off",defaultValue:l.email,type:"email",id:"email",placeholder:"email",className:"flex-grow text-xl pl-3 w-3/4 mx-auto text-gray-500 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:k,disabled:!0})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Password"}),e.jsxs("div",{className:"relative flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(fe,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{type:"text",id:"password",placeholder:"password",disabled:!0,className:"flex-grow w-52 text-xl pl-3 text-gray-700 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100"})]}),n.password&&e.jsx("div",{className:"absolute right-0 bottom-[127px] pr-5",children:e.jsx("button",{type:"button",onClick:I,children:i?e.jsx(R,{className:"text-slate-700"}):e.jsx(T,{className:"text-slate-600"})})}),e.jsx("div",{className:"flex",children:e.jsx("button",{type:"button",onClick:()=>w(!0),className:"font-semibold text-sm justify-left text-sky-600 hover:text-sky-400 duration-300 cursor-pointer",children:"Change Password"})}),e.jsx("button",{disabled:!J,className:" bg-blue-600 text-xl font-semibold text-white mt-6 p-3 rounded-lg hover:opacity-95 transition-all disabled:opacity-80",children:G?"Saving...":"Save Changes"})]})]})}),e.jsx("p",{className:"text-red-700 mt-7",children:E&&"something went wrong"}),e.jsx("p",{className:"text-green-700 mt-7",children:z&&"Updated Successfully"}),e.jsx("button",{onClick:X,className:"text-green-700 w-full",children:"Show Created Provider"}),e.jsx("p",{className:"text-red-700 mt-7",children:q?"Error showing Provider":""}),p&&p.length>0&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-center mt-7 text-2xl font-semibold",children:"Your Providers"}),p.map(s=>e.jsxs("div",{className:" rounded-lg p-3 flex gap-4 justify-between items-center",children:[e.jsx(v,{to:`/provider/${s.fullName}?id=${s._id}&service=${s.name[0]}`,children:e.jsx("img",{src:s.profilePicture,alt:"provider cover",className:"h-16 w-16 object-contain rounded-full"})}),e.jsx(v,{onClick:()=>c(ie(s._id)),className:"flex-1 font-semibold hover:underline truncate",to:`/provider/${s.fullName}?id=${s._id}&service=${s.name[0]}`,children:e.jsx("p",{children:s.fullName})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("button",{onClick:()=>Y(s._id),className:"text-red-700 uppercase",children:"Delete"}),e.jsx(v,{to:"/dashboard?tab=providers",children:e.jsx("button",{className:"text-green-700 uppercase",children:"EDIT"})})]})]},s._id))]})]})]})}export{ye as default};
