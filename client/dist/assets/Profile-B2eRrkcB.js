import{G as O,r as t,a as q,b as G,j as e,k as H,a2 as Z,a3 as J,L as w,V as K,Z as Q,n as W,q as y,t as Y,_ as S}from"./index-DX3LeXBM.js";import{g as X,r as ee,u as se,a as te}from"./index.esm2017-Bkp_8fr5.js";import{b as ae}from"./index-DYo2Gw2b.js";import{a as re}from"./index-BluXyhev.js";function le(c){return O({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(c)}function de(){const c=t.useRef(null),[m,P]=t.useState(),[d,C]=t.useState(0),[E,k]=t.useState(!1),[n,N]=t.useState({profilePicture:"",password:""}),x=t.useRef(null),[U,D]=t.useState(!1),[g,_]=t.useState(!1),[F,h]=t.useState(!1),[f,v]=t.useState([]),{currentUser:o,loading:I,error:$}=q(s=>s.user),[L,p]=t.useState(!1),i=G();t.useEffect(()=>{m&&R(m)},[m]);const R=async s=>{const a=X(Q),r=new Date().getTime()+s.name,b=ee(a,r),u=se(b,s);u.on("state_changed",l=>{const A=l.bytesTransferred/l.totalBytes*100;C(Math.round(A))},l=>{k(!0),console.log(l)},()=>{te(u.snapshot.ref).then(l=>{N({...n,profilePicture:l}),p(!0)})})},T=s=>{s.preventDefault(),c.current.click()},B=async s=>{s.preventDefault();try{x.current.continuousStart(50),i(W());const r=await(await fetch(`/server/user/update/${o._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();if(r.success===!1){i(y(r));return}i(Y(r)),D(!0),p(!1),S.success("Profile Updated Successfully")}catch(a){i(y(a))}finally{x.current.complete()}},j=s=>{s.target.id==="username"&&(s.target.value=s.target.value.replace(/[^a-zA-Z\s]/g,"")),N({...n,[s.target.id]:s.target.value}),p(!0)},M=async()=>{try{h(!1);const a=await(await fetch(`/server/user/providers/${o._id}`)).json();if(a.success===!1){h(!0);return}v(a)}catch{h(!0)}},V=async s=>{try{const r=await(await fetch(`/server/provider/delete/${s}`,{method:"DELETE"})).json();if(r.success===!1)return console.log(r),S.success("Provider Deleted Successfully");v(b=>b.filter(u=>u._id!==s))}catch(a){console.log(a.message)}},z=()=>{_(!g)};return e.jsxs("div",{className:"bg-slate-100 p-3 mx-auto",children:[e.jsx(H,{ref:x,color:"#ff9900",height:3}),e.jsxs("h1",{className:"flex flex-col p-2 mb-4 font-bold text-2xl text-gray",children:["Account Settings :"," "]}),e.jsxs("div",{className:"p-10 bg-white rounded-lg border",children:[e.jsx("div",{children:e.jsxs("form",{className:"flex flex-col items-start gap-7 md:w-[900px]",onSubmit:B,children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("input",{type:"file",id:"profilePicture",name:"profilePicture",ref:c,hidden:!0,accept:"image/*",onChange:s=>P(s.target.files[0])}),e.jsx("div",{className:"relative w-34 h-34 mx-auto group",children:e.jsxs("label",{htmlFor:"profilePicture",className:"w-24 h-24 cursor-pointer",onClick:T,children:[e.jsx("img",{src:o.profilePicture||n.profilePicture||"https://i.ibb.co/tKQH4zp/defaultprofile.jpg",alt:"profile",className:"w-32 h-32 rounded-full object-cover border-4 border-[lightgray]"}),e.jsxs("div",{className:"hidden rounded-full group-hover:flex flex-col items-center justify-center absolute inset-0 bg-gray-800 bg-opacity-60",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/33565/upload.svg",alt:"camera",className:"w-10 h-10"}),e.jsx("p",{className:"text-white text-xs",children:"Change Picture"})]})]})}),e.jsx("p",{className:"text-sm self-center",children:E?e.jsx("span",{className:"text-red-500",children:"Please upload a valid image"}):d>0&&d<100?e.jsx("span",{children:`Uploading: ${d}%`}):d===100?e.jsx("span",{className:"text-green-700",children:"Image Uploaded Successfully"}):""})]}),e.jsxs("div",{className:"flex flex-col w-72 md:w-1/2 gap-2 relative",children:[e.jsx("label",{htmlFor:"username",className:"text-xl text-slate-600",children:"Username"}),e.jsxs("div",{className:"flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(Z,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{defaultValue:o.username,type:"text",id:"username",maxLength:20,required:!0,placeholder:"username",className:" text-xl pl-3 w-52 text-gray-800 bg-state-100 p-3 rounded-lg ring-0 ring-inset py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:j})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Email Address"}),e.jsxs("div",{className:"flex items-center mt-2 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(le,{className:"ml-3 text-xls w-5 h-5 text-gray-400"}),e.jsx("input",{defaultValue:o.email,type:"email",id:"email",placeholder:"email",className:"flex-grow text-xl pl-3 w-3/4 mx-auto text-gray-500 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:j,disabled:!0})]}),e.jsx("label",{htmlFor:"username",className:"text-xl mt-4 text-slate-600",children:"Password"}),e.jsxs("div",{className:"relative flex items-center mt-2 w-50 h-14 rounded-lg ring-0 ring-inset border-0 focus:ring-2 bg-slate-100",children:[e.jsx(re,{className:"ml-3 text-xl text-gray-400"}),e.jsx("input",{type:g?"text":"password",id:"password",placeholder:"password",className:"flex-grow w-52 text-xl pl-3 text-gray-700 bg-state-100 p-3 rounded-lg ring-0 ring-inset ring-gray-300 py-1.5 border-0 focus:ring-2 bg-slate-100",onChange:j})]}),n.password&&e.jsx("div",{className:"absolute right-0 bottom-[127px] pr-5",children:e.jsx("button",{type:"button",onClick:z,children:g?e.jsx(J,{className:"text-slate-700"}):e.jsx(ae,{className:"text-slate-600"})})}),e.jsxs("h1",{className:"text-slate-500 font-semibold",children:[e.jsx("b",{children:"Note"}),": Enter new password to reset old password."]}),e.jsx("button",{disabled:!L,className:" bg-blue-600 text-xl font-semibold text-white mt-6 p-3 rounded-lg hover:opacity-95 transition-all disabled:opacity-80",children:I?"Saving...":"Save Changes"})]})]})}),e.jsx("p",{className:"text-red-700 mt-7",children:$&&"something went wrong"}),e.jsx("p",{className:"text-green-700 mt-7",children:U&&"Updated Successfully"}),e.jsx("button",{onClick:M,className:"text-green-700 w-full",children:"Show Created Provider"}),e.jsx("p",{className:"text-red-700 mt-7",children:F?"Error showing Provider":""}),f&&f.length>0&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-center mt-7 text-2xl font-semibold",children:"Your Providers"}),f.map(s=>e.jsxs("div",{className:" rounded-lg p-3 flex gap-4 justify-between items-center",children:[e.jsx(w,{to:`/provider/${s.fullName}?id=${s._id}&service=${s.name[0]}`,children:e.jsx("img",{src:s.profilePicture,alt:"provider cover",className:"h-16 w-16 object-contain rounded-full"})}),e.jsx(w,{onClick:()=>i(K(s._id)),className:"flex-1 font-semibold hover:underline truncate",to:`/provider/${s.fullName}?id=${s._id}&service=${s.name[0]}`,children:e.jsx("p",{children:s.fullName})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("button",{onClick:()=>V(s._id),className:"text-red-700 uppercase",children:"Delete"}),e.jsx(w,{to:"/dashboard?tab=providers",children:e.jsx("button",{className:"text-green-700 uppercase",children:"EDIT"})})]})]},s._id))]})]})]})}export{de as default};
